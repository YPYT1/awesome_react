# ä¸‰å…ƒè¿ç®—ç¬¦æ¸²æŸ“

## å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬ç« å­¦ä¹ ï¼Œä½ å°†å…¨é¢æŒæ¡ï¼š

- ä¸‰å…ƒè¿ç®—ç¬¦çš„åŸºæœ¬è¯­æ³•å’ŒåŸç†
- åœ¨JSXä¸­ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦çš„å„ç§åœºæ™¯
- åµŒå¥—ä¸‰å…ƒè¿ç®—ç¬¦çš„æŠ€å·§å’Œé™·é˜±
- ä¸‰å…ƒè¿ç®—ç¬¦vså…¶ä»–æ¡ä»¶æ¸²æŸ“æ–¹å¼çš„å¯¹æ¯”
- æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- å¯è¯»æ€§æå‡æŠ€å·§
- React 19ä¸­çš„æœ€ä½³å®è·µ

## ç¬¬ä¸€éƒ¨åˆ†ï¼šä¸‰å…ƒè¿ç®—ç¬¦åŸºç¡€

### 1.1 åŸºæœ¬è¯­æ³•

```jsx
// JavaScriptä¸‰å…ƒè¿ç®—ç¬¦è¯­æ³•
// condition ? expressionIfTrue : expressionIfFalse

// åŸºæœ¬ç¤ºä¾‹
const result = age >= 18 ? 'æˆå¹´' : 'æœªæˆå¹´';
const status = isOnline ? 'online' : 'offline';
const price = isMember ? 99 : 199;

// Reactä¸­çš„ä½¿ç”¨
function AgeCheck({ age }) {
  return (
    <div>
      {age >= 18 ? (
        <p>æ‚¨æ˜¯æˆå¹´äºº</p>
      ) : (
        <p>æ‚¨æ˜¯æœªæˆå¹´äºº</p>
      )}
    </div>
  );
}

// å†…è”ä½¿ç”¨
function StatusBadge({ isOnline }) {
  return (
    <span className={isOnline ? 'online' : 'offline'}>
      {isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}
    </span>
  );
}
```

### 1.2 ç®€å•æ¡ä»¶æ¸²æŸ“

```jsx
function SimpleConditional({ isLoggedIn, hasMessages, isLoading }) {
  return (
    <div>
      {/* æ¬¢è¿æ¶ˆæ¯ */}
      {isLoggedIn ? (
        <h1>æ¬¢è¿å›æ¥ï¼</h1>
      ) : (
        <h1>è¯·ç™»å½•</h1>
      )}
      
      {/* æ¶ˆæ¯æç¤º */}
      {hasMessages ? (
        <div className="alert">æ‚¨æœ‰æ–°æ¶ˆæ¯</div>
      ) : (
        <div className="info">æš‚æ— æ–°æ¶ˆæ¯</div>
      )}
      
      {/* åŠ è½½çŠ¶æ€ */}
      {isLoading ? (
        <div className="spinner">åŠ è½½ä¸­...</div>
      ) : (
        <div className="content">å†…å®¹å·²åŠ è½½</div>
      )}
    </div>
  );
}

// å†…è”æ–‡æœ¬åˆ‡æ¢
function InlineText({ count, isActive, hasError }) {
  return (
    <div>
      {/* å•å¤æ•° */}
      <p>
        ä½ æœ‰ {count} {count === 1 ? 'æ¡æ¶ˆæ¯' : 'æ¡æ¶ˆæ¯'}
      </p>
      
      {/* çŠ¶æ€æ–‡æœ¬ */}
      <p>
        çŠ¶æ€ï¼š{isActive ? 'æ¿€æ´»' : 'æœªæ¿€æ´»'}
      </p>
      
      {/* é”™è¯¯æç¤º */}
      <p className={hasError ? 'error' : 'success'}>
        {hasError ? 'æ“ä½œå¤±è´¥' : 'æ“ä½œæˆåŠŸ'}
      </p>
    </div>
  );
}

// æ¡ä»¶æ¸²æŸ“å±æ€§
function ConditionalProps({ isActive, isPrimary, size }) {
  return (
    <button
      className={isActive ? 'active' : 'inactive'}
      type={isPrimary ? 'submit' : 'button'}
      disabled={!isActive}
      style={{
        fontSize: size === 'large' ? '20px' : '14px',
        padding: size === 'large' ? '12px 24px' : '8px 16px'
      }}
    >
      {isActive ? 'æ¿€æ´»ä¸­' : 'å·²ç¦ç”¨'}
    </button>
  );
}
```

### 1.3 nullå€¼çš„ä½¿ç”¨

```jsx
function NullInTernary({ showDetails, hasData, isExpanded }) {
  return (
    <div>
      <h1>æ ‡é¢˜</h1>
      
      {/* ä¸æ˜¾ç¤ºæ—¶è¿”å›null */}
      {showDetails ? (
        <div className="details">
          <p>è¯¦ç»†ä¿¡æ¯</p>
          <p>æ›´å¤šå†…å®¹</p>
        </div>
      ) : null}
      
      {/* å¯ä»¥çœç•¥nullï¼ˆä½†æ˜¾å¼å†™å‡ºæ›´æ¸…æ™°ï¼‰ */}
      {hasData ? (
        <DataDisplay />
      ) : null}
      
      {/* å±•å¼€/æ”¶èµ· */}
      {isExpanded ? (
        <div className="expanded-content">
          <p>å±•å¼€çš„å†…å®¹</p>
        </div>
      ) : null}
    </div>
  );
}

// å¯¹æ¯”ï¼šé€»è¾‘ä¸è¿ç®—ç¬¦ï¼ˆæ›´ç®€æ´ï¼‰
function WithLogicalAnd({ showDetails }) {
  return (
    <div>
      <h1>æ ‡é¢˜</h1>
      
      {/* ä½¿ç”¨&&æ›´ç®€æ´ï¼ˆåªæœ‰trueåˆ†æ”¯ï¼‰ */}
      {showDetails && (
        <div className="details">
          <p>è¯¦ç»†ä¿¡æ¯</p>
        </div>
      )}
    </div>
  );
}

// ä½•æ—¶ç”¨ä¸‰å…ƒï¼Œä½•æ—¶ç”¨&&ï¼Ÿ
// - æœ‰trueå’Œfalseä¸¤ä¸ªåˆ†æ”¯ â†’ ç”¨ä¸‰å…ƒ
// - åªæœ‰trueåˆ†æ”¯ â†’ ç”¨&&
```

## ç¬¬äºŒéƒ¨åˆ†ï¼šåµŒå¥—ä¸‰å…ƒè¿ç®—ç¬¦

### 2.1 ä¸¤å±‚åµŒå¥—

```jsx
function TwoLevelNesting({ status, userType }) {
  // çŠ¶æ€æ¸²æŸ“
  return (
    <div>
      {status === 'loading' ? (
        <Spinner />
      ) : status === 'error' ? (
        <ErrorMessage />
      ) : (
        <Content />
      )}
    </div>
  );
}

// æ ¼å¼åŒ–æå‡å¯è¯»æ€§
function FormattedNesting({ status }) {
  return (
    <div>
      {status === 'loading' ? (
        <Spinner />
      ) : status === 'error' ? (
        <ErrorMessage />
      ) : (
        <Content />
      )}
    </div>
  );
}

// ç”¨æˆ·ç±»å‹æ¸²æŸ“
function UserTypeDisplay({ type }) {
  return (
    <div>
      {type === 'admin' ? (
        <AdminDashboard />
      ) : type === 'user' ? (
        <UserDashboard />
      ) : (
        <GuestView />
      )}
    </div>
  );
}
```

### 2.2 å¤šå±‚åµŒå¥—

```jsx
function MultiLevelNesting({ score, grade }) {
  // åˆ†æ•°ç­‰çº§
  return (
    <div>
      ç­‰çº§ï¼š
      {score >= 90 ? (
        'A'
      ) : score >= 80 ? (
        'B'
      ) : score >= 70 ? (
        'C'
      ) : score >= 60 ? (
        'D'
      ) : (
        'F'
      )}
    </div>
  );
}

// æ›´å¥½çš„æ ¼å¼ï¼ˆå•è¡Œï¼‰
function BetterFormatting({ score }) {
  return (
    <div>
      ç­‰çº§ï¼š
      {score >= 90 ? 'A' :
       score >= 80 ? 'B' :
       score >= 70 ? 'C' :
       score >= 60 ? 'D' : 'F'}
    </div>
  );
}

// ä½†å¤šå±‚åµŒå¥—ä¸æ¨èï¼Œåº”è¯¥é‡æ„
function Refactored({ score }) {
  // æ–¹æ¡ˆ1ï¼šä½¿ç”¨å‡½æ•°
  const getGrade = (score) => {
    if (score >= 90) return 'A';
    if (score >= 80) return 'B';
    if (score >= 70) return 'C';
    if (score >= 60) return 'D';
    return 'F';
  };
  
  return <div>ç­‰çº§ï¼š{getGrade(score)}</div>;
}

function RefactoredWithMap({ score }) {
  // æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ˜ å°„è¡¨
  const gradeRanges = [
    { min: 90, max: 100, grade: 'A' },
    { min: 80, max: 89, grade: 'B' },
    { min: 70, max: 79, grade: 'C' },
    { min: 60, max: 69, grade: 'D' },
    { min: 0, max: 59, grade: 'F' }
  ];
  
  const grade = gradeRanges.find(
    range => score >= range.min && score <= range.max
  )?.grade || 'F';
  
  return <div>ç­‰çº§ï¼š{grade}</div>;
}
```

### 2.3 ä½•æ—¶é¿å…åµŒå¥—

```jsx
// âŒ ä¸å¥½ï¼šéš¾ä»¥é˜…è¯»çš„æ·±å±‚åµŒå¥—
function BadNesting({ user, loading, error, data }) {
  return (
    <div>
      {loading ? (
        <Spinner />
      ) : error ? (
        <Error />
      ) : user ? (
        user.isPremium ? (
          user.isActive ? (
            user.hasAccess ? (
              data ? (
                <PremiumContent data={data} />
              ) : (
                <NoData />
              )
            ) : (
              <NoAccess />
            )
          ) : (
            <InactiveAccount />
          )
        ) : (
          user.trialExpired ? (
            <TrialExpired />
          ) : (
            <FreeContent />
          )
        )
      ) : (
        <Login />
      )}
    </div>
  );
}

// âœ… å¥½ï¼šæå‰è¿”å›ï¼ˆEarly Returnï¼‰
function GoodEarlyReturn({ user, loading, error, data }) {
  if (loading) return <Spinner />;
  if (error) return <Error />;
  if (!user) return <Login />;
  if (!user.isActive) return <InactiveAccount />;
  if (!user.hasAccess) return <NoAccess />;
  if (!data) return <NoData />;
  
  if (user.isPremium) {
    return <PremiumContent data={data} />;
  }
  
  if (user.trialExpired) {
    return <TrialExpired />;
  }
  
  return <FreeContent />;
}

// âœ… å¥½ï¼šæå–ä¸ºå‡½æ•°
function GoodExtractedFunction({ user, loading, error, data }) {
  function renderContent() {
    if (loading) return <Spinner />;
    if (error) return <Error />;
    if (!user) return <Login />;
    if (!user.isActive) return <InactiveAccount />;
    if (!user.hasAccess) return <NoAccess />;
    if (!data) return <NoData />;
    
    return user.isPremium ? <PremiumContent data={data} /> : <FreeContent />;
  }
  
  return <div className="container">{renderContent()}</div>;
}

// âœ… å¥½ï¼šæ‹†åˆ†ä¸ºç»„ä»¶
function GoodComponentSplit({ user, loading, error, data }) {
  if (loading) return <Spinner />;
  if (error) return <Error />;
  if (!user) return <Login />;
  
  return <UserContent user={user} data={data} />;
}

function UserContent({ user, data }) {
  if (!user.isActive) return <InactiveAccount />;
  if (!user.hasAccess) return <NoAccess />;
  if (!data) return <NoData />;
  
  return user.isPremium ? <PremiumContent data={data} /> : <FreeContent />;
}
```

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸‰å…ƒè¿ç®—ç¬¦çš„é«˜çº§ç”¨æ³•

### 3.1 æ¡ä»¶æ¸²æŸ“ç»„ä»¶

```jsx
function ConditionalComponent({ type, variant, mode }) {
  // æ ¹æ®typeé€‰æ‹©ç»„ä»¶
  const Component = type === 'button' ? Button : Input;
  
  return <Component />;
}

// åŠ¨æ€é€‰æ‹©ç»„ä»¶
function DynamicComponent({ componentType }) {
  const components = {
    button: Button,
    input: Input,
    select: Select,
    textarea: Textarea
  };
  
  const Component = components[componentType] || DefaultComponent;
  
  return <Component />;
}

// å¸¦Propsçš„åŠ¨æ€ç»„ä»¶
function DynamicWithProps({ type, ...props }) {
  const Component = type === 'primary' ? PrimaryButton : SecondaryButton;
  
  return <Component {...props} />;
}
```

### 3.2 æ¡ä»¶Props

```jsx
function ConditionalProps({ variant, size, disabled, loading }) {
  return (
    <button
      // æ¡ä»¶className
      className={variant === 'primary' ? 'btn-primary' : 'btn-secondary'}
      
      // æ¡ä»¶disabled
      disabled={disabled ? true : false}
      
      // æ¡ä»¶style
      style={{
        backgroundColor: variant === 'danger' ? 'red' : 'blue',
        fontSize: size === 'large' ? '20px' : size === 'small' ? '12px' : '16px',
        padding: size === 'large' ? '12px 24px' : '8px 16px'
      }}
      
      // æ¡ä»¶ariaå±æ€§
      aria-disabled={disabled ? 'true' : 'false'}
      aria-busy={loading ? 'true' : 'false'}
    >
      {loading ? 'åŠ è½½ä¸­...' : variant === 'primary' ? 'ç¡®è®¤' : 'å–æ¶ˆ'}
    </button>
  );
}

// æ¡ä»¶å±•å¼€props
function ConditionalSpread({ isEditable, data, mode }) {
  return (
    <Input
      value={data.value}
      
      {/* æ ¹æ®isEditableæ¡ä»¶å±•å¼€ä¸åŒprops */}
      {...(isEditable ? {
        onChange: handleChange,
        placeholder: 'è¯·è¾“å…¥',
        autoFocus: true
      } : {
        readOnly: true,
        disabled: true
      })}
      
      {/* æ ¹æ®modeå±•å¼€æ ·å¼ */}
      {...(mode === 'dark' ? {
        className: 'input-dark',
        style: { background: '#333', color: '#fff' }
      } : {
        className: 'input-light',
        style: { background: '#fff', color: '#000' }
      })}
    />
  );
}

// æ¡ä»¶äº‹ä»¶å¤„ç†å™¨
function ConditionalEventHandlers({ isEnabled, isReadOnly }) {
  return (
    <input
      onClick={isEnabled ? handleClick : undefined}
      onChange={isReadOnly ? undefined : handleChange}
      onFocus={isEnabled ? handleFocus : undefined}
    />
  );
}
```

### 3.3 æ¡ä»¶children

```jsx
function ConditionalChildren({ 
  hasHeader, 
  hasFooter, 
  hasSidebar,
  layoutMode,
  children 
}) {
  return (
    <div className="page-container">
      {/* æ¡ä»¶Header */}
      {hasHeader ? (
        <header className="page-header">
          <h1>ç½‘ç«™æ ‡é¢˜</h1>
          <nav>å¯¼èˆªèœå•</nav>
        </header>
      ) : null}
      
      <div className="page-content">
        {/* æ¡ä»¶Sidebar */}
        {hasSidebar ? (
          <aside className="sidebar">
            <p>ä¾§è¾¹æ å†…å®¹</p>
          </aside>
        ) : null}
        
        {/* ä¸»å†…å®¹åŒºåŸŸ */}
        <main className={layoutMode === 'wide' ? 'content-wide' : 'content-narrow'}>
          {children}
        </main>
      </div>
      
      {/* æ¡ä»¶Footer */}
      {hasFooter ? (
        <footer className="page-footer">
          <p>ç‰ˆæƒä¿¡æ¯ Â© 2024</p>
          <nav>åº•éƒ¨é“¾æ¥</nav>
        </footer>
      ) : null}
    </div>
  );
}

// å¤æ‚çš„å¸ƒå±€åˆ‡æ¢
function LayoutSwitch({ layout, children }) {
  return (
    <div>
      {layout === 'single' ? (
        <div className="single-column">{children}</div>
      ) : layout === 'double' ? (
        <div className="double-column">
          <div className="col-1">{children[0]}</div>
          <div className="col-2">{children[1]}</div>
        </div>
      ) : layout === 'triple' ? (
        <div className="triple-column">
          <div className="col-1">{children[0]}</div>
          <div className="col-2">{children[1]}</div>
          <div className="col-3">{children[2]}</div>
        </div>
      ) : (
        <div className="default-layout">{children}</div>
      )}
    </div>
  );
}
```

## ç¬¬å››éƒ¨åˆ†ï¼šä¸‰å…ƒè¿ç®—ç¬¦vså…¶ä»–æ¨¡å¼

### 4.1 vs if-elseè¯­å¥

```jsx
// if-elseï¼ˆé€‚åˆå¤æ‚é€»è¾‘ï¼Œå¤šæ¡è¯­å¥ï¼‰
function WithIfElse({ status, data, user }) {
  if (status === 'loading') {
    console.log('æ­£åœ¨åŠ è½½...');
    trackEvent('loading');
    return <Spinner />;
  }
  
  if (status === 'error') {
    console.error('åŠ è½½é”™è¯¯');
    trackError();
    return <ErrorMessage />;
  }
  
  if (!user) {
    redirectToLogin();
    return <Login />;
  }
  
  return <DataDisplay data={data} />;
}

// ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆé€‚åˆç®€å•äºŒé€‰ä¸€ï¼Œå•ä¸€è¡¨è¾¾å¼ï¼‰
function WithTernary({ status, data }) {
  return (
    <div>
      {status === 'loading' ? (
        <Spinner />
      ) : status === 'error' ? (
        <ErrorMessage />
      ) : (
        <DataDisplay data={data} />
      )}
    </div>
  );
}
```

### 4.2 vsé€»è¾‘ä¸è¿ç®—ç¬¦

```jsx
// é€»è¾‘ä¸ï¼ˆé€‚åˆå•ä¸€æ¡ä»¶ï¼Œåªæœ‰trueåˆ†æ”¯ï¼‰
function WithLogicalAnd({ showDetails, hasPermission }) {
  return (
    <div>
      <h1>æ ‡é¢˜</h1>
      {showDetails && <Details />}
      {hasPermission && <AdminPanel />}
    </div>
  );
}

// ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆé€‚åˆæœ‰trueå’Œfalseä¸¤ä¸ªåˆ†æ”¯ï¼‰
function WithTernary({ showDetails, hasPermission }) {
  return (
    <div>
      <h1>æ ‡é¢˜</h1>
      {showDetails ? <Details /> : <Placeholder />}
      {hasPermission ? <AdminPanel /> : <AccessDenied />}
    </div>
  );
}

// é€‰æ‹©å»ºè®®ï¼š
// - åªæœ‰ä¸€ä¸ªåˆ†æ”¯ â†’ ç”¨&&
// - æœ‰ä¸¤ä¸ªåˆ†æ”¯ â†’ ç”¨ä¸‰å…ƒ
// - æœ‰å¤šä¸ªåˆ†æ”¯ â†’ ç”¨if-elseæˆ–switch
```

### 4.3 vs switchè¯­å¥

```jsx
// switchï¼ˆé€‚åˆå¤šä¸ªæ˜ç¡®çš„åˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯é€»è¾‘å¤æ‚ï¼‰
function WithSwitch({ type }) {
  switch (type) {
    case 'info':
      console.log('ä¿¡æ¯ç±»å‹');
      return <InfoIcon />;
      
    case 'warning':
      console.log('è­¦å‘Šç±»å‹');
      return <WarningIcon />;
      
    case 'error':
      console.log('é”™è¯¯ç±»å‹');
      return <ErrorIcon />;
      
    case 'success':
      console.log('æˆåŠŸç±»å‹');
      return <SuccessIcon />;
      
    default:
      return <DefaultIcon />;
  }
}

// ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆåµŒå¥—å¤æ‚ï¼Œå¯è¯»æ€§å·®ï¼‰
function WithTernary({ type }) {
  return (
    <div>
      {type === 'info' ? (
        <InfoIcon />
      ) : type === 'warning' ? (
        <WarningIcon />
      ) : type === 'error' ? (
        <ErrorIcon />
      ) : type === 'success' ? (
        <SuccessIcon />
      ) : (
        <DefaultIcon />
      )}
    </div>
  );
}

// å¯¹è±¡æ˜ å°„ï¼ˆæ›´ç®€æ´çš„æ›¿ä»£æ–¹æ¡ˆï¼‰
function WithMapping({ type }) {
  const icons = {
    info: InfoIcon,
    warning: WarningIcon,
    error: ErrorIcon,
    success: SuccessIcon
  };
  
  const Icon = icons[type] || DefaultIcon;
  
  return <Icon />;
}
```

## ç¬¬äº”éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–

### 5.1 é¿å…é‡å¤è®¡ç®—

```jsx
// âŒ ä¸å¥½ï¼šé‡å¤è®¡ç®—
function BadRepeatCalculation({ items }) {
  return (
    <div>
      {items.length > 0 ? (
        <div>
          {/* items.lengthè®¡ç®—å¤šæ¬¡ */}
          <p>å…± {items.length} é¡¹</p>
          <p>æœ€åä¸€é¡¹ï¼š{items[items.length - 1]}</p>
          <ul>
            {items.map(item => <li key={item.id}>{item.name}</li>)}
          </ul>
        </div>
      ) : (
        <div>æš‚æ— æ•°æ®</div>
      )}
    </div>
  );
}

// âœ… å¥½ï¼šæå–å˜é‡
function GoodExtractVariable({ items }) {
  const hasItems = items.length > 0;
  const itemCount = items.length;
  const lastItem = items[itemCount - 1];
  
  return (
    <div>
      {hasItems ? (
        <div>
          <p>å…± {itemCount} é¡¹</p>
          <p>æœ€åä¸€é¡¹ï¼š{lastItem?.name}</p>
          <ul>
            {items.map(item => <li key={item.id}>{item.name}</li>)}
          </ul>
        </div>
      ) : (
        <div>æš‚æ— æ•°æ®</div>
      )}
    </div>
  );
}
```

### 5.2 ä½¿ç”¨useMemoç¼“å­˜æ¡ä»¶

```jsx
function MemoizedTernary({ showExpensive, data }) {
  // ç¼“å­˜æ˜‚è´µçš„è®¡ç®—
  const expensiveResult = useMemo(() => {
    if (!showExpensive) return null;
    
    console.log('æ‰§è¡Œæ˜‚è´µè®¡ç®—');
    return computeExpensive(data);
  }, [showExpensive, data]);
  
  return (
    <div>
      {showExpensive ? (
        <ExpensiveComponent result={expensiveResult} />
      ) : (
        <SimpleComponent />
      )}
    </div>
  );
}

// ç¼“å­˜æ¡ä»¶åˆ¤æ–­ç»“æœ
function CachedConditions({ users, filters }) {
  const filteredUsers = useMemo(() => {
    return users.filter(user => {
      // å¤æ‚çš„è¿‡æ»¤é€»è¾‘
      return matchesFilters(user, filters);
    });
  }, [users, filters]);
  
  const hasResults = filteredUsers.length > 0;
  
  return (
    <div>
      {hasResults ? (
        <UserList users={filteredUsers} />
      ) : (
        <EmptyState />
      )}
    </div>
  );
}
```

## ç¬¬å…­éƒ¨åˆ†ï¼šå®æˆ˜æ¡ˆä¾‹

### 6.1 è¡¨å•éªŒè¯åé¦ˆ

```jsx
function FormField({ value, error, touched, valid }) {
  return (
    <div className="form-field">
      <input value={value} />
      
      {touched ? (
        error ? (
          <span className="error-message">
            âœ— {error}
          </span>
        ) : valid ? (
          <span className="success-message">
            âœ“ æ ¼å¼æ­£ç¡®
          </span>
        ) : null
      ) : null}
    </div>
  );
}

// å®Œæ•´çš„è¡¨å•éªŒè¯
function ValidatedForm() {
  const [email, setEmail] = useState('');
  const [touched, setTouched] = useState(false);
  
  const isValid = /\S+@\S+\.\S+/.test(email);
  const error = email && !isValid ? 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®' : '';
  
  return (
    <div>
      <input
        value={email}
        onChange={e => setEmail(e.target.value)}
        onBlur={() => setTouched(true)}
        className={touched ? (isValid ? 'valid' : 'invalid') : ''}
      />
      
      {touched ? (
        isValid ? (
          <span className="success">âœ“ é‚®ç®±æ ¼å¼æ­£ç¡®</span>
        ) : (
          <span className="error">âœ— {error}</span>
        )
      ) : (
        <span className="hint">è¯·è¾“å…¥é‚®ç®±</span>
      )}
    </div>
  );
}
```

### 6.2 è´­ç‰©è½¦æ˜¾ç¤º

```jsx
function CartButton({ itemCount, total }) {
  return (
    <button className="cart-button">
      <span className="icon">ğŸ›’</span>
      <span className="text">è´­ç‰©è½¦</span>
      
      {/* æ•°é‡å¾½ç«  */}
      {itemCount > 0 ? (
        <span className="badge">
          {itemCount > 99 ? '99+' : itemCount}
        </span>
      ) : null}
      
      {/* æ€»ä»·æ˜¾ç¤º */}
      {total > 0 ? (
        <span className="total">
          Â¥{total > 10000 ? `${(total / 10000).toFixed(1)}ä¸‡` : total}
        </span>
      ) : null}
    </button>
  );
}

// è´­ç‰©è½¦è¯¦æƒ…
function CartDetails({ items }) {
  const itemCount = items.length;
  const total = items.reduce((sum, item) => sum + item.price * item.quantity, 0);
  const hasDiscount = total > 500;
  
  return (
    <div className="cart">
      <h2>è´­ç‰©è½¦</h2>
      
      {itemCount > 0 ? (
        <>
          <ul>
            {items.map(item => (
              <li key={item.id}>
                {item.name} Ã— {item.quantity}
                <span>Â¥{item.price * item.quantity}</span>
              </li>
            ))}
          </ul>
          
          <div className="summary">
            <p>å°è®¡ï¼šÂ¥{total}</p>
            
            {hasDiscount ? (
              <p className="discount">
                æ»¡500å‡50ï¼Œä¼˜æƒ ï¼šÂ¥50
              </p>
            ) : (
              <p className="tip">
                å†è´­Â¥{500 - total}å¯äº«ä¼˜æƒ 
              </p>
            )}
            
            <p className="total">
              æ€»è®¡ï¼šÂ¥{hasDiscount ? total - 50 : total}
            </p>
          </div>
        </>
      ) : (
        <div className="empty-cart">
          <p>è´­ç‰©è½¦æ˜¯ç©ºçš„</p>
          <button>å»è´­ç‰©</button>
        </div>
      )}
    </div>
  );
}
```

### 6.3 ç”¨æˆ·çŠ¶æ€æ˜¾ç¤º

```jsx
function UserStatus({ user }) {
  const isOnline = user.lastSeen && Date.now() - user.lastSeen < 300000;  // 5åˆ†é’Ÿå†…
  const isPremium = user.subscription === 'premium';
  const isVerified = user.emailVerified;
  
  return (
    <div className="user-status">
      {/* åœ¨çº¿çŠ¶æ€ */}
      <span className={isOnline ? 'status-online' : 'status-offline'}>
        {isOnline ? 'â— åœ¨çº¿' : 'â—‹ ç¦»çº¿'}
      </span>
      
      {/* ä¼šå‘˜çŠ¶æ€ */}
      {isPremium ? (
        <span className="badge-premium">VIPä¼šå‘˜</span>
      ) : user.trialDaysLeft > 0 ? (
        <span className="badge-trial">
          è¯•ç”¨ä¸­ï¼ˆå‰©ä½™{user.trialDaysLeft}å¤©ï¼‰
        </span>
      ) : (
        <span className="badge-free">å…è´¹ç”¨æˆ·</span>
      )}
      
      {/* è®¤è¯çŠ¶æ€ */}
      {isVerified ? (
        <span className="verified">âœ“ å·²è®¤è¯</span>
      ) : (
        <a href="/verify" className="verify-link">å»è®¤è¯</a>
      )}
      
      {/* æœ€ååœ¨çº¿æ—¶é—´ */}
      <span className="last-seen">
        {isOnline ? (
          'ç°åœ¨åœ¨çº¿'
        ) : user.lastSeen ? (
          `æœ€ååœ¨çº¿ï¼š${formatTimeAgo(user.lastSeen)}`
        ) : (
          'ä»æœªåœ¨çº¿'
        )}
      </span>
    </div>
  );
}

function formatTimeAgo(timestamp) {
  const seconds = Math.floor((Date.now() - timestamp) / 1000);
  
  if (seconds < 60) return 'åˆšåˆš';
  if (seconds < 3600) return `${Math.floor(seconds / 60)}åˆ†é’Ÿå‰`;
  if (seconds < 86400) return `${Math.floor(seconds / 3600)}å°æ—¶å‰`;
  return `${Math.floor(seconds / 86400)}å¤©å‰`;
}
```

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå¯è¯»æ€§ä¼˜åŒ–

### 7.1 æå–æ¡ä»¶å˜é‡

```jsx
// âŒ ä¸å¥½ï¼šå†…è”å¤æ‚æ¡ä»¶
function BadInlineCondition({ user }) {
  return (
    <div>
      {user && user.subscription === 'premium' && user.credits > 100 ? (
        <PremiumFeature />
      ) : (
        <StandardFeature />
      )}
    </div>
  );
}

// âœ… å¥½ï¼šæå–ä¸ºå˜é‡
function GoodExtractedCondition({ user }) {
  const canAccessPremium = user && 
                          user.subscription === 'premium' && 
                          user.credits > 100;
  
  return (
    <div>
      {canAccessPremium ? (
        <PremiumFeature />
      ) : (
        <StandardFeature />
      )}
    </div>
  );
}

// âœ… æ›´å¥½ï¼šæå–ä¸ºå‡½æ•°
function BestExtractedFunction({ user }) {
  const canAccessPremium = () => {
    if (!user) return false;
    if (user.subscription !== 'premium') return false;
    if (user.credits <= 100) return false;
    return true;
  };
  
  return (
    <div>
      {canAccessPremium() ? (
        <PremiumFeature />
      ) : (
        <StandardFeature />
      )}
    </div>
  );
}
```

### 7.2 ä½¿ç”¨å¸¸é‡æå‡å¯è¯»æ€§

```jsx
// âŒ ä¸å¥½ï¼šé­”æ³•å­—ç¬¦ä¸²
function BadMagicStrings({ status }) {
  return (
    <div>
      {status === 'pending' ? (
        <Pending />
      ) : status === 'approved' ? (
        <Approved />
      ) : status === 'rejected' ? (
        <Rejected />
      ) : (
        <Unknown />
      )}
    </div>
  );
}

// âœ… å¥½ï¼šä½¿ç”¨å¸¸é‡
const STATUS = {
  PENDING: 'pending',
  APPROVED: 'approved',
  REJECTED: 'rejected'
};

function GoodWithConstants({ status }) {
  return (
    <div>
      {status === STATUS.PENDING ? (
        <Pending />
      ) : status === STATUS.APPROVED ? (
        <Approved />
      ) : status === STATUS.REJECTED ? (
        <Rejected />
      ) : (
        <Unknown />
      )}
    </div>
  );
}
```

## ç¬¬å…«éƒ¨åˆ†ï¼šè¾¹ç•Œæƒ…å†µå¤„ç†

### 8.1 å¤„ç†nullå’Œundefined

```jsx
function HandleNullUndefined({ data }) {
  return (
    <div>
      {/* æ£€æŸ¥dataæ˜¯å¦å­˜åœ¨ */}
      {data ? (
        data.items ? (
          data.items.length > 0 ? (
            <ItemList items={data.items} />
          ) : (
            <Empty message="åˆ—è¡¨ä¸ºç©º" />
          )
        ) : (
          <Empty message="æ— itemsæ•°æ®" />
        )
      ) : (
        <Empty message="æ— æ•°æ®" />
      )}
      
      {/* ä½¿ç”¨å¯é€‰é“¾ç®€åŒ– */}
      {data?.items?.length > 0 ? (
        <ItemList items={data.items} />
      ) : (
        <Empty />
      )}
    </div>
  );
}
```

### 8.2 å¤„ç†ç©ºæ•°ç»„å’Œç©ºå¯¹è±¡

```jsx
function HandleEmptyCollections({ items, config }) {
  const hasItems = Array.isArray(items) && items.length > 0;
  const hasConfig = config && Object.keys(config).length > 0;
  
  return (
    <div>
      {hasItems ? (
        <ul>
          {items.map(item => <li key={item.id}>{item.name}</li>)}
        </ul>
      ) : (
        <p>æ²¡æœ‰é¡¹ç›®</p>
      )}
      
      {hasConfig ? (
        <ConfigDisplay config={config} />
      ) : (
        <p>æ²¡æœ‰é…ç½®</p>
      )}
    </div>
  );
}
```

## ç»ƒä¹ é¢˜

### åŸºç¡€ç»ƒä¹ 

1. ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦å®ç°ç™»å½•/æœªç™»å½•æ˜¾ç¤º
2. åˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºæˆç»©ç­‰çº§çš„ç»„ä»¶
3. å®ç°æ¡ä»¶æ ·å¼åº”ç”¨
4. å¤„ç†0å€¼çš„æ­£ç¡®æ¸²æŸ“

### è¿›é˜¶ç»ƒä¹ 

1. é‡æ„å¤æ‚çš„åµŒå¥—ä¸‰å…ƒè¿ç®—ç¬¦
2. å®ç°è¡¨å•éªŒè¯åé¦ˆç³»ç»Ÿ
3. åˆ›å»ºæ¡ä»¶æ¸²æŸ“çš„å¯¼èˆªèœå•
4. å¯¹æ¯”ä¸åŒæ¡ä»¶æ¸²æŸ“æ–¹å¼çš„æ€§èƒ½

### é«˜çº§ç»ƒä¹ 

1. å®ç°ä¸€ä¸ªæ™ºèƒ½ç»„ä»¶é€‰æ‹©å™¨
2. åˆ›å»ºå¤æ‚çš„å¸ƒå±€åˆ‡æ¢ç³»ç»Ÿ
3. ä¼˜åŒ–ä¸‰å…ƒè¿ç®—ç¬¦çš„æ¸²æŸ“æ€§èƒ½
4. å®ç°åŠŸèƒ½å¼€å…³ï¼ˆFeature Toggleï¼‰ç³»ç»Ÿ

é€šè¿‡æœ¬ç« å­¦ä¹ ï¼Œä½ å·²ç»å…¨é¢æŒæ¡äº†ä¸‰å…ƒè¿ç®—ç¬¦åœ¨Reactä¸­çš„åº”ç”¨ã€‚åˆç†ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦èƒ½è®©ä½ çš„ä»£ç æ›´åŠ ç®€æ´æ˜äº†ã€‚è®°ä½ï¼šç®€å•åœºæ™¯ç”¨ä¸‰å…ƒï¼Œå¤æ‚é€»è¾‘ç”¨if-elseï¼ç»§ç»­å­¦ä¹ ï¼Œæ¢ç´¢æ›´å¤šæ¸²æŸ“æŠ€å·§ï¼
