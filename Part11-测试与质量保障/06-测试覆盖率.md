# æµ‹è¯•è¦†ç›–ç‡

## æ¦‚è¿°

æµ‹è¯•è¦†ç›–ç‡æ˜¯è¡¡é‡ä»£ç æµ‹è¯•å®Œæ•´æ€§çš„é‡è¦æŒ‡æ ‡,å®ƒå¸®åŠ©è¯†åˆ«æœªæµ‹è¯•çš„ä»£ç è·¯å¾„,æé«˜ä»£ç è´¨é‡ã€‚æœ¬æ–‡å°†å…¨é¢ä»‹ç»æµ‹è¯•è¦†ç›–ç‡çš„æ¦‚å¿µã€æŒ‡æ ‡ã€å·¥å…·é…ç½®ä»¥åŠå¦‚ä½•æå‡å’Œç»´æŠ¤é«˜è´¨é‡çš„æµ‹è¯•è¦†ç›–ç‡ã€‚

## è¦†ç›–ç‡æŒ‡æ ‡

### å››å¤§è¦†ç›–ç‡æŒ‡æ ‡

```typescript
// ç¤ºä¾‹ä»£ç 
function divide(a: number, b: number): number {
  if (b === 0) {                    // åˆ†æ”¯1
    throw new Error('Division by zero');
  }
  return a / b;                     // åˆ†æ”¯2
}

// æµ‹è¯•ç”¨ä¾‹
describe('divide', () => {
  // è¦†ç›–ç‡åˆ†æ:
  // âœ… è¯­å¥è¦†ç›–ç‡(Statement Coverage): 100% - æ‰€æœ‰è¯­å¥éƒ½æ‰§è¡Œ
  // âœ… åˆ†æ”¯è¦†ç›–ç‡(Branch Coverage): 100% - ä¸¤ä¸ªåˆ†æ”¯éƒ½è¦†ç›–
  // âœ… å‡½æ•°è¦†ç›–ç‡(Function Coverage): 100% - divideå‡½æ•°è¢«è°ƒç”¨
  // âœ… è¡Œè¦†ç›–ç‡(Line Coverage): 100% - æ‰€æœ‰è¡Œéƒ½æ‰§è¡Œ
  
  it('should divide numbers', () => {
    expect(divide(6, 2)).toBe(3);    // è¦†ç›–åˆ†æ”¯2
  });
  
  it('should throw error for zero', () => {
    expect(() => divide(6, 0)).toThrow(); // è¦†ç›–åˆ†æ”¯1
  });
});
```

### è¯­å¥è¦†ç›–ç‡

```typescript
function processUser(user: User | null) {
  if (!user) {              // è¯­å¥1
    return null;            // è¯­å¥2
  }
  
  const name = user.name;   // è¯­å¥3
  const email = user.email; // è¯­å¥4
  
  return { name, email };   // è¯­å¥5
}

// 50%è¯­å¥è¦†ç›–ç‡
test('partial statement coverage', () => {
  const result = processUser({ name: 'John', email: 'john@example.com' });
  expect(result).toEqual({ name: 'John', email: 'john@example.com' });
  // åªè¦†ç›–è¯­å¥3,4,5
});

// 100%è¯­å¥è¦†ç›–ç‡
test('full statement coverage', () => {
  expect(processUser(null)).toBeNull(); // è¦†ç›–è¯­å¥1,2
  const result = processUser({ name: 'John', email: 'john@example.com' });
  expect(result).toEqual({ name: 'John', email: 'john@example.com' }); // è¦†ç›–è¯­å¥3,4,5
});
```

### åˆ†æ”¯è¦†ç›–ç‡

```typescript
function getDiscount(user: User): number {
  if (user.isPremium) {
    if (user.loyaltyPoints > 1000) {
      return 0.2;  // åˆ†æ”¯A
    }
    return 0.1;    // åˆ†æ”¯B
  }
  return 0;        // åˆ†æ”¯C
}

// 33%åˆ†æ”¯è¦†ç›–ç‡
test('partial branch coverage', () => {
  expect(getDiscount({ isPremium: false, loyaltyPoints: 0 })).toBe(0);
  // åªè¦†ç›–åˆ†æ”¯C
});

// 100%åˆ†æ”¯è¦†ç›–ç‡
describe('full branch coverage', () => {
  it('premium with high loyalty', () => {
    expect(getDiscount({ isPremium: true, loyaltyPoints: 1500 })).toBe(0.2); // åˆ†æ”¯A
  });
  
  it('premium with low loyalty', () => {
    expect(getDiscount({ isPremium: true, loyaltyPoints: 500 })).toBe(0.1); // åˆ†æ”¯B
  });
  
  it('non-premium', () => {
    expect(getDiscount({ isPremium: false, loyaltyPoints: 0 })).toBe(0); // åˆ†æ”¯C
  });
});
```

### å‡½æ•°è¦†ç›–ç‡

```typescript
// utils.ts
export function add(a: number, b: number) {
  return a + b;
}

export function multiply(a: number, b: number) {
  return a * b;
}

export function subtract(a: number, b: number) {
  return a - b;
}

// 33%å‡½æ•°è¦†ç›–ç‡
test('partial function coverage', () => {
  expect(add(1, 2)).toBe(3);
  // åªæµ‹è¯•äº†addå‡½æ•°
});

// 100%å‡½æ•°è¦†ç›–ç‡
describe('full function coverage', () => {
  test('add', () => expect(add(1, 2)).toBe(3));
  test('multiply', () => expect(multiply(2, 3)).toBe(6));
  test('subtract', () => expect(subtract(5, 2)).toBe(3));
});
```

### è¡Œè¦†ç›–ç‡

```typescript
function complexCalculation(x: number, y: number) {
  const sum = x + y;        // è¡Œ1
  const product = x * y;    // è¡Œ2
  const result = 
    sum > 10 ? 
      product : 
      sum;                  // è¡Œ3-5
  return result;            // è¡Œ6
}

// è¡Œè¦†ç›–ç‡ç»Ÿè®¡ä¼šè®¡ç®—å®é™…æ‰§è¡Œçš„ä»£ç è¡Œæ•°
```

## Jestè¦†ç›–ç‡é…ç½®

### package.jsoné…ç½®

```json
{
  "scripts": {
    "test": "jest",
    "test:coverage": "jest --coverage",
    "test:coverage:watch": "jest --coverage --watch"
  },
  "jest": {
    "collectCoverage": true,
    "collectCoverageFrom": [
      "src/**/*.{js,jsx,ts,tsx}",
      "!src/**/*.d.ts",
      "!src/**/*.stories.{js,jsx,ts,tsx}",
      "!src/**/__tests__/**",
      "!src/index.tsx"
    ],
    "coverageThreshold": {
      "global": {
        "branches": 80,
        "functions": 80,
        "lines": 80,
        "statements": 80
      }
    },
    "coverageReporters": ["text", "lcov", "html"],
    "coverageDirectory": "coverage"
  }
}
```

### jest.config.jsé…ç½®

```javascript
module.exports = {
  collectCoverage: true,
  
  // æ”¶é›†è¦†ç›–ç‡çš„æ–‡ä»¶
  collectCoverageFrom: [
    'src/**/*.{js,jsx,ts,tsx}',
    '!src/**/*.d.ts',
    '!src/**/*.stories.{js,jsx,ts,tsx}',
    '!src/index.tsx',
    '!src/serviceWorker.ts',
  ],
  
  // è¦†ç›–ç‡é˜ˆå€¼
  coverageThreshold: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80,
    },
    // ç‰¹å®šè·¯å¾„çš„é˜ˆå€¼
    './src/components/': {
      branches: 90,
      functions: 90,
      lines: 90,
      statements: 90,
    },
    './src/utils/': {
      branches: 100,
      functions: 100,
      lines: 100,
      statements: 100,
    },
  },
  
  // æŠ¥å‘Šæ ¼å¼
  coverageReporters: [
    'text',        // ç»ˆç«¯è¾“å‡º
    'text-summary', // ç®€çŸ­æ‘˜è¦
    'html',        // HTMLæŠ¥å‘Š
    'lcov',        // LCOVæ ¼å¼(CIå·¥å…·ä½¿ç”¨)
    'json',        // JSONæ ¼å¼
    'cobertura',   // Coberturaæ ¼å¼
  ],
  
  // è¦†ç›–ç‡æŠ¥å‘Šç›®å½•
  coverageDirectory: 'coverage',
  
  // è¦†ç›–ç‡æä¾›è€…
  coverageProvider: 'v8', // æˆ– 'babel'
};
```

## è¦†ç›–ç‡æŠ¥å‘Š

### ç»ˆç«¯æŠ¥å‘Š

```bash
npm test -- --coverage

# è¾“å‡º:
# ----------------------|---------|----------|---------|---------|-------------------
# File                  | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
# ----------------------|---------|----------|---------|---------|-------------------
# All files            |   85.71 |    83.33 |   88.89 |   85.71 |
#  components          |   90.00 |    87.50 |   92.31 |   90.00 |
#   Button.tsx         |   95.00 |    90.00 |   100   |   95.00 | 25-27
#   Input.tsx          |   85.00 |    85.00 |   84.62 |   85.00 | 18,34,56
#  utils               |   80.00 |    75.00 |   83.33 |   80.00 |
#   format.ts          |   100   |    100   |   100   |   100   |
#   validate.ts        |   60.00 |    50.00 |   66.67 |   60.00 | 12-15,28-30
# ----------------------|---------|----------|---------|---------|-------------------
```

### HTMLæŠ¥å‘Š

```bash
npm test -- --coverage

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€: coverage/lcov-report/index.html
```

HTMLæŠ¥å‘Šæä¾›:
- ğŸ“Š å¯è§†åŒ–è¦†ç›–ç‡å›¾è¡¨
- ğŸ“ æ–‡ä»¶å¤¹å’Œæ–‡ä»¶çº§åˆ«çš„è¦†ç›–ç‡
- ğŸ” ä»£ç é«˜äº®æ˜¾ç¤ºè¦†ç›–/æœªè¦†ç›–çš„è¡Œ
- ğŸ“ˆ è¦†ç›–ç‡è¶‹åŠ¿(é…åˆCI)

### JSONæŠ¥å‘Š

```json
{
  "total": {
    "lines": { "total": 100, "covered": 85, "skipped": 0, "pct": 85 },
    "statements": { "total": 120, "covered": 102, "skipped": 0, "pct": 85 },
    "functions": { "total": 30, "covered": 27, "skipped": 0, "pct": 90 },
    "branches": { "total": 40, "covered": 33, "skipped": 0, "pct": 82.5 }
  },
  "files": {
    "src/utils/format.ts": {
      "lines": { "total": 20, "covered": 20, "pct": 100 }
    }
  }
}
```

## æå‡è¦†ç›–ç‡

### è¯†åˆ«æœªè¦†ç›–ä»£ç 

```typescript
// ä½¿ç”¨è¦†ç›–ç‡æŠ¥å‘Šè¯†åˆ«æœªè¦†ç›–çš„åˆ†æ”¯
function processOrder(order: Order) {
  if (!order.items || order.items.length === 0) {
    throw new Error('Empty order');
  }
  
  let total = 0;
  for (const item of order.items) {
    total += item.price * item.quantity;
    
    // âŒ æœªè¦†ç›–åˆ†æ”¯
    if (item.discount) {
      total -= item.discount;
    }
  }
  
  // âŒ æœªè¦†ç›–åˆ†æ”¯
  if (order.coupon) {
    total *= (1 - order.coupon.discount);
  }
  
  return total;
}

// æ·»åŠ æµ‹è¯•è¦†ç›–æœªè¦†ç›–çš„åˆ†æ”¯
describe('processOrder coverage', () => {
  it('should apply item discount', () => {
    const order = {
      items: [
        { price: 100, quantity: 1, discount: 10 }
      ]
    };
    expect(processOrder(order)).toBe(90);
  });
  
  it('should apply coupon discount', () => {
    const order = {
      items: [{ price: 100, quantity: 1 }],
      coupon: { discount: 0.1 }
    };
    expect(processOrder(order)).toBe(90);
  });
});
```

### è¾¹ç•Œæ¡ä»¶æµ‹è¯•

```typescript
function calculateAge(birthDate: Date): number {
  const today = new Date();
  let age = today.getFullYear() - birthDate.getFullYear();
  const monthDiff = today.getMonth() - birthDate.getMonth();
  
  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
    age--;
  }
  
  return age;
}

describe('calculateAge boundary tests', () => {
  // æ­£å¸¸æƒ…å†µ
  it('should calculate age', () => {
    const birthDate = new Date('1990-01-01');
    expect(calculateAge(birthDate)).toBeGreaterThan(30);
  });
  
  // è¾¹ç•Œ: ç”Ÿæ—¥è¿˜æœªåˆ°
  it('should handle birthday not yet reached', () => {
    const today = new Date();
    const birthDate = new Date(today.getFullYear() - 20, today.getMonth() + 1, today.getDate());
    expect(calculateAge(birthDate)).toBe(19);
  });
  
  // è¾¹ç•Œ: åŒæœˆä½†æ—¥æœŸæœªåˆ°
  it('should handle same month but date not reached', () => {
    const today = new Date();
    const birthDate = new Date(today.getFullYear() - 20, today.getMonth(), today.getDate() + 1);
    expect(calculateAge(birthDate)).toBe(19);
  });
  
  // è¾¹ç•Œ: ä»Šå¤©æ˜¯ç”Ÿæ—¥
  it('should handle birthday today', () => {
    const today = new Date();
    const birthDate = new Date(today.getFullYear() - 20, today.getMonth(), today.getDate());
    expect(calculateAge(birthDate)).toBe(20);
  });
});
```

### é”™è¯¯è·¯å¾„è¦†ç›–

```typescript
async function fetchUserProfile(userId: number) {
  if (userId < 0) {
    throw new Error('Invalid user ID');
  }
  
  try {
    const response = await fetch(`/api/users/${userId}`);
    
    if (!response.ok) {
      if (response.status === 404) {
        throw new Error('User not found');
      }
      throw new Error('Server error');
    }
    
    return await response.json();
  } catch (error) {
    if (error.name === 'NetworkError') {
      throw new Error('Network connection failed');
    }
    throw error;
  }
}

describe('fetchUserProfile error paths', () => {
  it('should throw for invalid ID', async () => {
    await expect(fetchUserProfile(-1)).rejects.toThrow('Invalid user ID');
  });
  
  it('should throw for 404', async () => {
    (global.fetch as jest.Mock).mockResolvedValue({
      ok: false,
      status: 404,
    });
    await expect(fetchUserProfile(1)).rejects.toThrow('User not found');
  });
  
  it('should throw for server error', async () => {
    (global.fetch as jest.Mock).mockResolvedValue({
      ok: false,
      status: 500,
    });
    await expect(fetchUserProfile(1)).rejects.toThrow('Server error');
  });
  
  it('should handle network error', async () => {
    const networkError = new Error('Failed to fetch');
    networkError.name = 'NetworkError';
    (global.fetch as jest.Mock).mockRejectedValue(networkError);
    
    await expect(fetchUserProfile(1)).rejects.toThrow('Network connection failed');
  });
});
```

## è¦†ç›–ç‡æœ€ä½³å®è·µ

### åˆç†çš„è¦†ç›–ç‡ç›®æ ‡

```javascript
// ä¸åŒæ¨¡å—çš„ä¸åŒæ ‡å‡†
module.exports = {
  coverageThreshold: {
    // å…¨å±€æœ€ä½æ ‡å‡†
    global: {
      branches: 70,
      functions: 75,
      lines: 75,
      statements: 75,
    },
    
    // æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ - é«˜æ ‡å‡†
    './src/core/': {
      branches: 90,
      functions: 95,
      lines: 95,
      statements: 95,
    },
    
    // å·¥å…·å‡½æ•° - æœ€é«˜æ ‡å‡†
    './src/utils/': {
      branches: 100,
      functions: 100,
      lines: 100,
      statements: 100,
    },
    
    // UIç»„ä»¶ - ä¸­ç­‰æ ‡å‡†
    './src/components/': {
      branches: 75,
      functions: 80,
      lines: 80,
      statements: 80,
    },
  },
};
```

### å¿½ç•¥ä¸éœ€è¦æµ‹è¯•çš„ä»£ç 

```typescript
// é…ç½®å¿½ç•¥
// jest.config.js
module.exports = {
  collectCoverageFrom: [
    'src/**/*.{js,jsx,ts,tsx}',
    '!src/**/*.d.ts',
    '!src/**/*.stories.{js,jsx,ts,tsx}',
    '!src/index.tsx',
    '!src/reportWebVitals.ts',
  ],
};

// ä½¿ç”¨æ³¨é‡Šå¿½ç•¥
function debugOnly() {
  /* istanbul ignore next */
  if (process.env.NODE_ENV === 'development') {
    console.log('Debug info');
  }
}

// å¿½ç•¥æ•´ä¸ªæ–‡ä»¶
/* istanbul ignore file */

// å¿½ç•¥ç‰¹å®šè¡Œ
const x = 1; /* istanbul ignore next */
const y = 2;
```

### å…³æ³¨è¦†ç›–è´¨é‡è€Œéæ•°é‡

```typescript
// âŒ ä½è´¨é‡çš„100%è¦†ç›–ç‡
test('bad coverage', () => {
  const result = complexFunction(input);
  expect(result).toBeDefined(); // åªéªŒè¯æœ‰è¿”å›å€¼
});

// âœ… é«˜è´¨é‡çš„è¦†ç›–ç‡
describe('good coverage', () => {
  it('should handle valid input', () => {
    const result = complexFunction({ valid: true });
    expect(result.status).toBe('success');
    expect(result.data).toEqual(expectedData);
  });
  
  it('should handle invalid input', () => {
    expect(() => complexFunction({ valid: false }))
      .toThrow('Invalid input');
  });
  
  it('should handle edge case', () => {
    const result = complexFunction({ edge: true });
    expect(result.handled).toBe(true);
  });
});
```

## CI/CDé›†æˆ

### GitHub Actions

```yaml
# .github/workflows/test.yml
name: Test Coverage

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run tests with coverage
        run: npm test -- --coverage
      
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/coverage-final.json
          fail_ci_if_error: true
      
      - name: Check coverage thresholds
        run: npm test -- --coverage --coverageThreshold='{"global":{"branches":80,"functions":80,"lines":80,"statements":80}}'
```

### è¦†ç›–ç‡æŠ¥å‘ŠæœåŠ¡

```yaml
# Codecové…ç½®
# codecov.yml
coverage:
  status:
    project:
      default:
        target: 80%
        threshold: 1%
    patch:
      default:
        target: 80%

comment:
  layout: "reach,diff,flags,files,footer"
  behavior: default
  require_changes: false
```

## è¦†ç›–ç‡å·¥å…·

### NYC (Istanbul)

```bash
npm install --save-dev nyc

# package.json
{
  "scripts": {
    "test": "nyc mocha"
  },
  "nyc": {
    "reporter": ["html", "text", "lcov"],
    "exclude": [
      "**/*.spec.ts",
      "**/*.test.ts"
    ],
    "all": true
  }
}
```

### è¦†ç›–ç‡å¾½ç« 

```markdown
# README.md
[![Coverage Status](https://codecov.io/gh/username/repo/branch/main/graph/badge.svg)](https://codecov.io/gh/username/repo)

[![Coverage](https://img.shields.io/codecov/c/github/username/repo)](https://codecov.io/gh/username/repo)
```

## å®æˆ˜æ¡ˆä¾‹

### 1. Reactç»„ä»¶è¦†ç›–ç‡

```typescript
// Button.tsx
interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  loading?: boolean;
  onClick?: () => void;
  children: React.ReactNode;
}

export function Button({
  variant = 'primary',
  size = 'md',
  disabled = false,
  loading = false,
  onClick,
  children,
}: ButtonProps) {
  const handleClick = () => {
    if (!disabled && !loading && onClick) {
      onClick();
    }
  };
  
  return (
    <button
      className={`btn btn-${variant} btn-${size}`}
      disabled={disabled || loading}
      onClick={handleClick}
    >
      {loading ? 'Loading...' : children}
    </button>
  );
}

// Button.test.tsx - 100%è¦†ç›–ç‡
describe('Button', () => {
  it('should render primary button', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByRole('button')).toHaveClass('btn-primary btn-md');
  });
  
  it('should render all variants', () => {
    const { rerender } = render(<Button variant="secondary">Test</Button>);
    expect(screen.getByRole('button')).toHaveClass('btn-secondary');
    
    rerender(<Button variant="danger">Test</Button>);
    expect(screen.getByRole('button')).toHaveClass('btn-danger');
  });
  
  it('should render all sizes', () => {
    const { rerender } = render(<Button size="sm">Test</Button>);
    expect(screen.getByRole('button')).toHaveClass('btn-sm');
    
    rerender(<Button size="lg">Test</Button>);
    expect(screen.getByRole('button')).toHaveClass('btn-lg');
  });
  
  it('should handle click', async () => {
    const handleClick = jest.fn();
    const user = userEvent.setup();
    
    render(<Button onClick={handleClick}>Click</Button>);
    await user.click(screen.getByRole('button'));
    
    expect(handleClick).toHaveBeenCalledTimes(1);
  });
  
  it('should not click when disabled', async () => {
    const handleClick = jest.fn();
    const user = userEvent.setup();
    
    render(<Button disabled onClick={handleClick}>Click</Button>);
    await user.click(screen.getByRole('button'));
    
    expect(handleClick).not.toHaveBeenCalled();
  });
  
  it('should not click when loading', async () => {
    const handleClick = jest.fn();
    const user = userEvent.setup();
    
    render(<Button loading onClick={handleClick}>Click</Button>);
    
    expect(screen.getByText('Loading...')).toBeInTheDocument();
    await user.click(screen.getByRole('button'));
    expect(handleClick).not.toHaveBeenCalled();
  });
});
```

### 2. å¤æ‚é€»è¾‘è¦†ç›–ç‡

```typescript
// orderProcessor.ts
export function processOrder(order: Order): ProcessedOrder {
  // éªŒè¯è®¢å•
  if (!order.items || order.items.length === 0) {
    throw new Error('Empty order');
  }
  
  let subtotal = 0;
  
  // è®¡ç®—å°è®¡
  for (const item of order.items) {
    if (item.quantity <= 0) {
      throw new Error(`Invalid quantity for item ${item.id}`);
    }
    
    let itemTotal = item.price * item.quantity;
    
    // åº”ç”¨å•†å“æŠ˜æ‰£
    if (item.discount) {
      itemTotal -= item.discount;
    }
    
    subtotal += itemTotal;
  }
  
  // åº”ç”¨ä¼˜æƒ åˆ¸
  if (order.coupon) {
    if (order.coupon.minAmount && subtotal < order.coupon.minAmount) {
      throw new Error('Order does not meet coupon minimum');
    }
    subtotal *= (1 - order.coupon.discount);
  }
  
  // è®¡ç®—è¿è´¹
  let shipping = 0;
  if (order.shippingMethod === 'express') {
    shipping = 15;
  } else if (order.shippingMethod === 'standard') {
    shipping = subtotal >= 50 ? 0 : 5;
  }
  
  const total = subtotal + shipping;
  
  return {
    orderId: order.id,
    subtotal,
    shipping,
    total,
    items: order.items,
  };
}

// å®Œæ•´è¦†ç›–ç‡æµ‹è¯•
describe('processOrder - Full Coverage', () => {
  it('should throw for empty order', () => {
    expect(() => processOrder({ id: '1', items: [] }))
      .toThrow('Empty order');
  });
  
  it('should throw for invalid quantity', () => {
    expect(() => processOrder({
      id: '1',
      items: [{ id: '1', price: 10, quantity: 0 }]
    })).toThrow('Invalid quantity');
  });
  
  it('should calculate basic order', () => {
    const result = processOrder({
      id: '1',
      items: [
        { id: '1', price: 10, quantity: 2 },
        { id: '2', price: 15, quantity: 1 },
      ],
    });
    
    expect(result.subtotal).toBe(35);
    expect(result.total).toBe(35);
  });
  
  it('should apply item discount', () => {
    const result = processOrder({
      id: '1',
      items: [
        { id: '1', price: 100, quantity: 1, discount: 10 },
      ],
    });
    
    expect(result.subtotal).toBe(90);
  });
  
  it('should apply coupon', () => {
    const result = processOrder({
      id: '1',
      items: [{ id: '1', price: 100, quantity: 1 }],
      coupon: { discount: 0.1 },
    });
    
    expect(result.subtotal).toBe(90);
  });
  
  it('should check coupon minimum', () => {
    expect(() => processOrder({
      id: '1',
      items: [{ id: '1', price: 10, quantity: 1 }],
      coupon: { discount: 0.1, minAmount: 50 },
    })).toThrow('Order does not meet coupon minimum');
  });
  
  it('should calculate express shipping', () => {
    const result = processOrder({
      id: '1',
      items: [{ id: '1', price: 10, quantity: 1 }],
      shippingMethod: 'express',
    });
    
    expect(result.shipping).toBe(15);
  });
  
  it('should calculate standard shipping - free', () => {
    const result = processOrder({
      id: '1',
      items: [{ id: '1', price: 50, quantity: 1 }],
      shippingMethod: 'standard',
    });
    
    expect(result.shipping).toBe(0);
  });
  
  it('should calculate standard shipping - paid', () => {
    const result = processOrder({
      id: '1',
      items: [{ id: '1', price: 10, quantity: 1 }],
      shippingMethod: 'standard',
    });
    
    expect(result.shipping).toBe(5);
  });
});
```

## æ€»ç»“

æµ‹è¯•è¦†ç›–ç‡æ˜¯ä»£ç è´¨é‡çš„é‡è¦æŒ‡æ ‡,ä½†ä¸åº”ç›²ç›®è¿½æ±‚100%ã€‚å…³é”®æ˜¯:
- âœ… è®¾ç½®åˆç†çš„è¦†ç›–ç‡ç›®æ ‡
- âœ… å…³æ³¨è¦†ç›–è´¨é‡è€Œéæ•°é‡
- âœ… è¦†ç›–å…³é”®è·¯å¾„å’Œè¾¹ç•Œæ¡ä»¶
- âœ… é›†æˆåˆ°CI/CDæµç¨‹
- âœ… æŒç»­ç›‘æ§å’Œæ”¹è¿›

é€šè¿‡åˆç†ä½¿ç”¨è¦†ç›–ç‡å·¥å…·å’Œæœ€ä½³å®è·µ,å¯ä»¥æœ‰æ•ˆæå‡ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚

