<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React 19 æ¡†æ¶ä½“éªŒ - Todoåº”ç”¨</title>
    
    <!-- ===== å¤–éƒ¨ä¾èµ–åº“ ===== -->
    <!-- React  æ ¸å¿ƒåº“ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <!-- React DOM  æ¸²æŸ“åº“ -->
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel è½¬è¯‘å™¨ï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­è½¬è¯‘JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* ===== CSS å…¨å±€æ ·å¼é‡ç½® ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ===== CSS å˜é‡å®šä¹‰ ===== */
        /* å®šä¹‰å…¨å±€é¢œè‰²å˜é‡ï¼Œä¾¿äºä¸»é¢˜ç®¡ç†å’Œç»´æŠ¤ */
        :root {
            --primary-color: #667eea;      /* ä¸»è‰²è°ƒï¼šç´«è“è‰² */
            --primary-dark: #5a67d8;       /* ä¸»è‰²è°ƒæ·±è‰²ç‰ˆæœ¬ */
            --secondary-color: #f093fb;    /* æ¬¡è¦è‰²ï¼šç²‰ç´«è‰² */
            --success-color: #48bb78;      /* æˆåŠŸè‰²ï¼šç»¿è‰² */
            --warning-color: #ed8936;      /* è­¦å‘Šè‰²ï¼šæ©™è‰² */
            --danger-color: #f56565;       /* å±é™©è‰²ï¼šçº¢è‰² */
            --text-primary: #2d3748;       /* ä¸»è¦æ–‡æœ¬è‰² */
            --text-secondary: #718096;     /* æ¬¡è¦æ–‡æœ¬è‰² */
            --bg-primary: #ffffff;         /* ä¸»èƒŒæ™¯è‰² */
            --bg-secondary: #f7fafc;       /* æ¬¡è¦èƒŒæ™¯è‰² */
            --border-color: #e2e8f0;       /* è¾¹æ¡†è‰² */
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);  /* é˜´å½±æ•ˆæœ */
        }

        /* ===== é¡µé¢åŸºç¡€æ ·å¼ ===== */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* ===== å®¹å™¨å¸ƒå±€æ ·å¼ ===== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* é¡µé¢å¤´éƒ¨æ ·å¼ */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* åº”ç”¨ä¸»å®¹å™¨ï¼šä¾§è¾¹æ  + ä¸»å†…å®¹çš„å¼¹æ€§å¸ƒå±€ */
        .app-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        /* ===== ä¾§è¾¹æ æ ·å¼ ===== */
        .sidebar {
            width: 300px;
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            position: sticky;  /* ç²˜æ€§å®šä½ï¼Œæ»šåŠ¨æ—¶ä¿æŒåœ¨è§†çª—å†… */
            top: 20px;
        }

        /* ä¾§è¾¹æ æ ‡é¢˜ */
        .sidebar h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.2rem;
        }

        /* ===== ç»Ÿè®¡å¡ç‰‡æ ·å¼ ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;  /* 2åˆ—ç½‘æ ¼å¸ƒå±€ */
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid var(--primary-color);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ===== è¿›åº¦æ¡æ ·å¼ ===== */
        .progress-section {
            margin-bottom: 25px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--primary-color));
            border-radius: 4px;
            transition: width 0.3s ease;  /* è¿›åº¦å˜åŒ–åŠ¨ç”» */
        }

        .progress-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* ===== ç­›é€‰å™¨æ ·å¼ ===== */
        .filter-section {
            margin-bottom: 20px;
        }

        .filter-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-btn {
            padding: 10px 15px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateX(5px);  /* æ‚¬åœæ—¶è½»å¾®å³ç§»æ•ˆæœ */
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* ===== å¯¼å‡ºæŒ‰é’®æ ·å¼ ===== */
        .export-section {
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
        }

        .export-btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background: white;
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* ===== ä¸»å†…å®¹åŒºåŸŸæ ·å¼ ===== */
        .main-content {
            flex: 1;  /* å æ®å‰©ä½™ç©ºé—´ */
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        /* ===== è¡¨å•æ ·å¼ ===== */
        .todo-form {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid transparent;
            transition: border-color 0.3s ease;
        }

        .todo-form:focus-within {
            border-color: var(--primary-color);  /* è¡¨å•è·å¾—ç„¦ç‚¹æ—¶çš„è¾¹æ¡†è‰² */
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--text-primary);
        }

        /* å¿…å¡«å­—æ®µæ ‡è®° */
        .required {
            color: var(--danger-color);
        }

        /* è¾“å…¥æ¡†åŸºç¡€æ ·å¼ */
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;  /* åªå…è®¸å‚ç›´è°ƒæ•´å¤§å° */
            min-height: 80px;
        }

        /* ===== æŒ‰é’®æ ·å¼ç³»ç»Ÿ ===== */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        /* ä¸»è¦æŒ‰é’®æ ·å¼ */
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);  /* æ‚¬åœæ—¶ä¸Šæµ®æ•ˆæœ */
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);
        }

        /* æ¬¡è¦æŒ‰é’®æ ·å¼ */
        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
            transform: translateY(-1px);
        }

        /* å±é™©æŒ‰é’®æ ·å¼ï¼ˆåˆ é™¤ç­‰æ“ä½œï¼‰ */
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #e53e3e;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(245, 101, 101, 0.3);
        }

        /* æˆåŠŸæŒ‰é’®æ ·å¼ */
        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(72, 187, 120, 0.3);
        }

        /* ===== ä»»åŠ¡åˆ—è¡¨æ ·å¼ ===== */
        .todo-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* å•ä¸ªä»»åŠ¡é¡¹æ ·å¼ */
        .todo-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
            position: relative;
        }

        .todo-item:hover {
            transform: translateY(-2px);  /* æ‚¬åœæ—¶ä¸Šæµ® */
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        /* å·²å®Œæˆä»»åŠ¡çš„æ ·å¼ */
        .todo-item.completed {
            opacity: 0.7;
            border-left-color: var(--success-color);
        }

        .todo-item.completed .todo-title {
            text-decoration: line-through;
            color: var(--text-secondary);
        }

        /* ä¼˜å…ˆçº§æŒ‡ç¤ºæ¡ */
        .priority-indicator {
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            border-radius: 0 0 0 10px;
        }

        .priority-high { background: var(--danger-color); }
        .priority-medium { background: var(--warning-color); }
        .priority-low { background: var(--success-color); }

        /* ä»»åŠ¡å¤´éƒ¨ï¼šæ ‡é¢˜å’Œæ“ä½œæŒ‰é’® */
        .todo-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .todo-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .todo-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: scale(1.05);  /* æ‚¬åœæ—¶è½»å¾®æ”¾å¤§ */
        }

        /* ä»»åŠ¡æè¿° */
        .todo-description {
            color: var(--text-secondary);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        /* ä»»åŠ¡å…ƒä¿¡æ¯ï¼ˆä¼˜å…ˆçº§ã€åˆ†ç±»ã€æˆªæ­¢æ—¥æœŸï¼‰ */
        .todo-meta {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ä¼˜å…ˆçº§æ ‡è®°æ ·å¼ */
        .priority-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            color: white;
        }

        .priority-badge.high { background: var(--danger-color); }
        .priority-badge.medium { background: var(--warning-color); }
        .priority-badge.low { background: var(--success-color); }

        /* åˆ†ç±»æ ‡ç­¾æ ·å¼ */
        .category-tag {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            border: 1px solid var(--border-color);
        }

        /* æˆªæ­¢æ—¥æœŸæ ·å¼ */
        .due-date {
            color: var(--text-secondary);
        }

        .due-date.overdue {
            color: var(--danger-color);
            font-weight: 600;
        }

        /* ===== æœç´¢æ¡†æ ·å¼ ===== */
        .search-container {
            margin-bottom: 25px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;  /* å·¦ä¾§ç•™ç©ºé—´ç»™æœç´¢å›¾æ ‡ */
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        /* ===== ç©ºçŠ¶æ€æ ·å¼ ===== */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .empty-state p {
            font-size: 1.1rem;
            max-width: 400px;
            margin: 0 auto;
        }

        /* ===== æ¨¡æ€æ¡†æ ·å¼ ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal {
            background: white;
            border-radius: 12px;
            padding: 0;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow: hidden;
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            margin: 0;
            color: var(--text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        /* ===== åŠ¨ç”»æ•ˆæœ ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                position: static;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .todo-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .todo-meta {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Reactåº”ç”¨çš„æŒ‚è½½ç‚¹ -->
    <div id="root"></div>

    <!-- Reactåº”ç”¨çš„JavaScriptä»£ç  -->
    <script type="text/babel">
        // ===== React Hooks è§£æ„ =====
        // ä»Reactä¸­è§£æ„å‡ºå¸¸ç”¨çš„Hooksï¼Œé¿å…é‡å¤å†™React.useStateç­‰
        const { useState, useEffect, useMemo, useCallback, useRef } = React;

        // ===== å·¥å…·å‡½æ•° =====
        
        // ç”Ÿæˆå”¯ä¸€IDçš„å‡½æ•°
        // ä½¿ç”¨æ—¶é—´æˆ³å’Œéšæœºæ•°ç»„åˆï¼Œç¡®ä¿IDçš„å”¯ä¸€æ€§
        const generateId = () => {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        };

        // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
        // å°†ISOæ—¥æœŸå­—ç¬¦ä¸²è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„æ ¼å¼
        const formatDate = (dateString) => {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        };

        // æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²é€¾æœŸ
        // æ¯”è¾ƒæˆªæ­¢æ—¥æœŸä¸å½“å‰æ—¥æœŸ
        const isOverdue = (dueDate) => {
            if (!dueDate) return false;
            const today = new Date();
            const due = new Date(dueDate);
            // è®¾ç½®æ—¶é—´ä¸ºå½“å¤©å¼€å§‹ï¼Œåªæ¯”è¾ƒæ—¥æœŸä¸æ¯”è¾ƒæ—¶é—´
            today.setHours(0, 0, 0, 0);
            due.setHours(0, 0, 0, 0);
            return due < today;
        };

        // å¯¼å‡ºæ•°æ®ä¸ºJSONæ ¼å¼
        const exportToJSON = (todos) => {
            const dataStr = JSON.stringify(todos, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `todos-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);  // æ¸…ç†å†…å­˜
        };

        // å¯¼å‡ºæ•°æ®ä¸ºCSVæ ¼å¼
        const exportToCSV = (todos) => {
            // CSVè¡¨å¤´
            const headers = ['æ ‡é¢˜', 'æè¿°', 'ä¼˜å…ˆçº§', 'åˆ†ç±»', 'æˆªæ­¢æ—¥æœŸ', 'çŠ¶æ€', 'åˆ›å»ºæ—¶é—´'];
            
            // è½¬æ¢æ•°æ®ä¸ºCSVè¡Œ
            const csvData = todos.map(todo => [
                todo.title,
                todo.description,
                todo.priority,
                todo.category,
                todo.dueDate ? formatDate(todo.dueDate) : '',
                todo.completed ? 'å·²å®Œæˆ' : 'å¾…å®Œæˆ',
                formatDate(todo.createdAt)
            ]);
            
            // ç»„åˆè¡¨å¤´å’Œæ•°æ®
            const csvContent = [headers, ...csvData]
                .map(row => row.map(field => `"${field}"`).join(','))
                .join('\n');
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const dataBlob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `todos-${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            URL.revokeObjectURL(url);
        };

        // ===== è‡ªå®šä¹‰Hookï¼šæœ¬åœ°å­˜å‚¨ =====
        // è¿™ä¸ªHookå°è£…äº†localStorageçš„è¯»å†™æ“ä½œï¼Œæä¾›ç±»ä¼¼useStateçš„æ¥å£
        const useLocalStorage = (key, initialValue) => {
            // ä½¿ç”¨useStateæ¥ç®¡ç†çŠ¶æ€ï¼Œåˆå§‹å€¼ä»localStorageè¯»å–
            const [storedValue, setStoredValue] = useState(() => {
                try {
                    // å°è¯•ä»localStorageè·å–æ•°æ®
                    const item = window.localStorage.getItem(key);
                    // å¦‚æœå­˜åœ¨æ•°æ®ï¼Œè§£æJSONï¼›å¦åˆ™è¿”å›åˆå§‹å€¼
                    return item ? JSON.parse(item) : initialValue;
                } catch (error) {
                    // å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›åˆå§‹å€¼
                    console.error(`Error reading localStorage key "${key}":`, error);
                    return initialValue;
                }
            });

            // å°è£…çš„è®¾ç½®å‡½æ•°ï¼ŒåŒæ—¶æ›´æ–°stateå’ŒlocalStorage
            const setValue = useCallback((value) => {
                try {
                    // æ”¯æŒå‡½æ•°å¼æ›´æ–°ï¼ˆç±»ä¼¼useStateï¼‰
                    const valueToStore = value instanceof Function ? value(storedValue) : value;
                    // æ›´æ–°ReactçŠ¶æ€
                    setStoredValue(valueToStore);
                    // åŒæ­¥åˆ°localStorage
                    window.localStorage.setItem(key, JSON.stringify(valueToStore));
                } catch (error) {
                    console.error(`Error setting localStorage key "${key}":`, error);
                }
            }, [key, storedValue]);

            // è¿”å›å½“å‰å€¼å’Œè®¾ç½®å‡½æ•°ï¼Œç±»ä¼¼useStateçš„è¿”å›å€¼
            return [storedValue, setValue];
        };

        // ===== è‡ªå®šä¹‰Hookï¼šé˜²æŠ– =====
        // é˜²æŠ–Hookï¼Œç”¨äºå»¶è¿Ÿæ‰§è¡Œé¢‘ç¹å˜åŒ–çš„å€¼ï¼ˆå¦‚æœç´¢è¾“å…¥ï¼‰
        const useDebounce = (value, delay) => {
            // å­˜å‚¨é˜²æŠ–åçš„å€¼
            const [debouncedValue, setDebouncedValue] = useState(value);

            useEffect(() => {
                // è®¾ç½®å®šæ—¶å™¨ï¼Œåœ¨delayæ¯«ç§’åæ›´æ–°é˜²æŠ–å€¼
                const handler = setTimeout(() => {
                    setDebouncedValue(value);
                }, delay);

                // æ¸…ç†å‡½æ•°ï¼šå¦‚æœvalueåœ¨delayæ—¶é—´å†…å†æ¬¡å˜åŒ–ï¼Œæ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
                return () => {
                    clearTimeout(handler);
                };
            }, [value, delay]); // ä¾èµ–valueå’Œdelay

            return debouncedValue;
        };

        // ===== Reactç»„ä»¶ï¼šä»»åŠ¡è¡¨å• =====
        // ç”¨äºæ·»åŠ æ–°ä»»åŠ¡æˆ–ç¼–è¾‘ç°æœ‰ä»»åŠ¡çš„è¡¨å•ç»„ä»¶
        const TodoForm = ({ onAddTodo, editingTodo, onUpdateTodo, onCancelEdit }) => {
            // ===== è¡¨å•çŠ¶æ€ç®¡ç† =====
            const [formData, setFormData] = useState({
                title: '',
                description: '',
                priority: 'medium',
                category: '',
                dueDate: ''
            });

            // ===== ç¼–è¾‘æ¨¡å¼å¤„ç† =====
            // å½“editingTodoå˜åŒ–æ—¶ï¼Œæ›´æ–°è¡¨å•æ•°æ®
            useEffect(() => {
                if (editingTodo) {
                    // ç¼–è¾‘æ¨¡å¼ï¼šå¡«å……ç°æœ‰ä»»åŠ¡æ•°æ®
                    setFormData({
                        title: editingTodo.title || '',
                        description: editingTodo.description || '',
                        priority: editingTodo.priority || 'medium',
                        category: editingTodo.category || '',
                        dueDate: editingTodo.dueDate || ''
                    });
                } else {
                    // æ·»åŠ æ¨¡å¼ï¼šé‡ç½®è¡¨å•
                    setFormData({
                        title: '',
                        description: '',
                        priority: 'medium',
                        category: '',
                        dueDate: ''
                    });
                }
            }, [editingTodo]);

            // ===== è¡¨å•å¤„ç†å‡½æ•° =====
            
            // å¤„ç†è¾“å…¥æ¡†å˜åŒ–
            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: value
                }));
            };

            // å¤„ç†è¡¨å•æäº¤
            const handleSubmit = (e) => {
                e.preventDefault();  // é˜»æ­¢é»˜è®¤çš„è¡¨å•æäº¤è¡Œä¸º
                
                // è¡¨å•éªŒè¯ï¼šæ ‡é¢˜æ˜¯å¿…å¡«çš„
                if (!formData.title.trim()) {
                    alert('è¯·è¾“å…¥ä»»åŠ¡æ ‡é¢˜');
                    return;
                }

                if (editingTodo) {
                    // ç¼–è¾‘æ¨¡å¼ï¼šæ›´æ–°ç°æœ‰ä»»åŠ¡
                    onUpdateTodo(editingTodo.id, formData);
                } else {
                    // æ·»åŠ æ¨¡å¼ï¼šåˆ›å»ºæ–°ä»»åŠ¡
                    onAddTodo(formData);
                    // é‡ç½®è¡¨å•
                    setFormData({
                        title: '',
                        description: '',
                        priority: 'medium',
                        category: '',
                        dueDate: ''
                    });
                }
            };

            // ===== ç»„ä»¶æ¸²æŸ“ =====
            return (
                <form className="todo-form" onSubmit={handleSubmit}>
                    {/* ç¬¬ä¸€è¡Œï¼šæ ‡é¢˜å’Œä¼˜å…ˆçº§ */}
                    <div className="form-row">
                        <div className="form-group">
                            <label htmlFor="title">
                                ä»»åŠ¡æ ‡é¢˜ <span className="required">*</span>
                            </label>
                            <input
                                type="text"
                                id="title"
                                name="title"
                                value={formData.title}
                                onChange={handleInputChange}
                                placeholder="è¾“å…¥ä»»åŠ¡æ ‡é¢˜..."
                                required
                            />
                        </div>
                        <div className="form-group">
                            <label htmlFor="priority">ä¼˜å…ˆçº§</label>
                            <select
                                id="priority"
                                name="priority"
                                value={formData.priority}
                                onChange={handleInputChange}
                            >
                                <option value="low">ä½ä¼˜å…ˆçº§</option>
                                <option value="medium">ä¸­ä¼˜å…ˆçº§</option>
                                <option value="high">é«˜ä¼˜å…ˆçº§</option>
                            </select>
                        </div>
                    </div>

                    {/* ç¬¬äºŒè¡Œï¼šåˆ†ç±»å’Œæˆªæ­¢æ—¥æœŸ */}
                    <div className="form-row">
                        <div className="form-group">
                            <label htmlFor="category">åˆ†ç±»</label>
                            <input
                                type="text"
                                id="category"
                                name="category"
                                value={formData.category}
                                onChange={handleInputChange}
                                placeholder="å·¥ä½œã€å­¦ä¹ ã€ç”Ÿæ´»..."
                            />
                        </div>
                        <div className="form-group">
                            <label htmlFor="dueDate">æˆªæ­¢æ—¥æœŸ</label>
                            <input
                                type="date"
                                id="dueDate"
                                name="dueDate"
                                value={formData.dueDate}
                                onChange={handleInputChange}
                            />
                        </div>
                    </div>

                    {/* ç¬¬ä¸‰è¡Œï¼šæè¿° */}
                    <div className="form-group">
                        <label htmlFor="description">ä»»åŠ¡æè¿°</label>
                        <textarea
                            id="description"
                            name="description"
                            value={formData.description}
                            onChange={handleInputChange}
                            placeholder="è¯¦ç»†æè¿°ä»»åŠ¡å†…å®¹..."
                            rows="3"
                        />
                    </div>

                    {/* æ“ä½œæŒ‰é’® */}
                    <div style={{ display: 'flex', gap: '10px', justifyContent: 'flex-end' }}>
                        {editingTodo && (
                            <button
                                type="button"
                                className="btn btn-secondary"
                                onClick={onCancelEdit}
                            >
                                å–æ¶ˆç¼–è¾‘
                            </button>
                        )}
                        <button type="submit" className="btn btn-primary">
                            {editingTodo ? 'æ›´æ–°ä»»åŠ¡' : 'æ·»åŠ ä»»åŠ¡'}
                        </button>
                    </div>
                </form>
            );
        };

        // ===== Reactç»„ä»¶ï¼šä»»åŠ¡é¡¹ =====
        // æ˜¾ç¤ºå•ä¸ªä»»åŠ¡çš„ç»„ä»¶ï¼ŒåŒ…å«æ‰€æœ‰ä»»åŠ¡ä¿¡æ¯å’Œæ“ä½œæŒ‰é’®
        const TodoItem = ({ todo, onToggle, onDelete, onEdit }) => {
            // æ ¹æ®ä¼˜å…ˆçº§è·å–å¯¹åº”çš„é¢œè‰²ç±»å
            const getPriorityColor = (priority) => {
                const colors = {
                    high: '#f56565',    // çº¢è‰²
                    medium: '#ed8936',  // æ©™è‰²
                    low: '#48bb78'     // ç»¿è‰²
                };
                return colors[priority] || colors.medium;
            };

            // æ ¹æ®åˆ†ç±»è·å–å¯¹åº”çš„å›¾æ ‡
            const getCategoryIcon = (category) => {
                const icons = {
                    'å·¥ä½œ': 'ğŸ’¼',
                    'å­¦ä¹ ': 'ğŸ“š',
                    'ç”Ÿæ´»': 'ğŸ ',
                    'å¥åº·': 'ğŸ’ª',
                    'å¨±ä¹': 'ğŸ®',
                    'è´­ç‰©': 'ğŸ›’'
                };
                return icons[category] || 'ğŸ“';
            };

            return (
                <div className={`todo-item ${todo.completed ? 'completed' : ''}`}>
                    {/* ä¼˜å…ˆçº§æŒ‡ç¤ºæ¡ */}
                    <div 
                        className="priority-indicator"
                        style={{ backgroundColor: getPriorityColor(todo.priority) }}
                    />
                    
                    {/* ä»»åŠ¡å¤´éƒ¨ï¼šæ ‡é¢˜å’Œæ“ä½œæŒ‰é’® */}
                    <div className="todo-header">
                        <h3 className="todo-title">{todo.title}</h3>
                        <div className="todo-actions">
                            <button
                                className="action-btn btn-success"
                                onClick={() => onToggle(todo.id)}
                                title={todo.completed ? 'æ ‡è®°ä¸ºæœªå®Œæˆ' : 'æ ‡è®°ä¸ºå·²å®Œæˆ'}
                            >
                                {todo.completed ? 'â†©ï¸' : 'âœ…'}
                            </button>
                            <button
                                className="action-btn btn-secondary"
                                onClick={() => onEdit(todo)}
                                title="ç¼–è¾‘ä»»åŠ¡"
                            >
                                âœï¸
                            </button>
                            <button
                                className="action-btn btn-danger"
                                onClick={() => onDelete(todo.id)}
                                title="åˆ é™¤ä»»åŠ¡"
                            >
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>

                    {/* ä»»åŠ¡æè¿° */}
                    {todo.description && (
                        <p className="todo-description">{todo.description}</p>
                    )}

                    {/* ä»»åŠ¡å…ƒä¿¡æ¯ */}
                    <div className="todo-meta">
                        {/* ä¼˜å…ˆçº§æ ‡è®° */}
                        <div className="meta-item">
                            <span className={`priority-badge ${todo.priority}`}>
                                {todo.priority === 'high' ? 'é«˜ä¼˜å…ˆçº§' : 
                                 todo.priority === 'medium' ? 'ä¸­ä¼˜å…ˆçº§' : 'ä½ä¼˜å…ˆçº§'}
                            </span>
                        </div>

                        {/* åˆ†ç±»æ ‡ç­¾ */}
                        {todo.category && (
                            <div className="meta-item">
                                <span className="category-tag">
                                    {getCategoryIcon(todo.category)} {todo.category}
                                </span>
                            </div>
                        )}

                        {/* æˆªæ­¢æ—¥æœŸ */}
                        {todo.dueDate && (
                            <div className="meta-item">
                                <span className={`due-date ${isOverdue(todo.dueDate) && !todo.completed ? 'overdue' : ''}`}>
                                    ğŸ“… {formatDate(todo.dueDate)}
                                    {isOverdue(todo.dueDate) && !todo.completed && ' (å·²é€¾æœŸ)'}
                                </span>
                            </div>
                        )}

                        {/* åˆ›å»ºæ—¶é—´ */}
                        <div className="meta-item">
                            <span>ğŸ•’ {formatDate(todo.createdAt)}</span>
                        </div>
                    </div>
                </div>
            );
        };

        // ===== Reactç»„ä»¶ï¼šä¾§è¾¹æ  =====
        // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ã€è¿›åº¦æ¡å’Œç­›é€‰å™¨çš„ä¾§è¾¹æ ç»„ä»¶
        const Sidebar = ({ todos, filter, setFilter, priorityFilter, setPriorityFilter, onExport }) => {
            // ===== ç»Ÿè®¡æ•°æ®è®¡ç®— =====
            // ä½¿ç”¨useMemoç¼“å­˜è®¡ç®—ç»“æœï¼Œé¿å…æ¯æ¬¡æ¸²æŸ“éƒ½é‡æ–°è®¡ç®—
            const stats = useMemo(() => {
                const total = todos.length;
                const completed = todos.filter(todo => todo.completed).length;
                const pending = total - completed;
                const overdue = todos.filter(todo => 
                    !todo.completed && todo.dueDate && isOverdue(todo.dueDate)
                ).length;
                
                return { total, completed, pending, overdue };
            }, [todos]);

            // è®¡ç®—å®Œæˆè¿›åº¦ç™¾åˆ†æ¯”
            const completionRate = stats.total > 0 ? (stats.completed / stats.total) * 100 : 0;

            return (
                <div className="sidebar">
                    {/* ç»Ÿè®¡ä¿¡æ¯ */}
                    <div className="stats-section">
                        <h3>ğŸ“Š ä»»åŠ¡ç»Ÿè®¡</h3>
                        <div className="stats-grid">
                            <div className="stat-card">
                                <div className="stat-number">{stats.total}</div>
                                <div className="stat-label">æ€»ä»»åŠ¡</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-number">{stats.completed}</div>
                                <div className="stat-label">å·²å®Œæˆ</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-number">{stats.pending}</div>
                                <div className="stat-label">å¾…å®Œæˆ</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-number">{stats.overdue}</div>
                                <div className="stat-label">å·²é€¾æœŸ</div>
                            </div>
                        </div>
                    </div>

                    {/* å®Œæˆè¿›åº¦ */}
                    <div className="progress-section">
                        <h3>ğŸ“ˆ å®Œæˆè¿›åº¦</h3>
                        <div className="progress-bar">
                            <div 
                                className="progress-fill" 
                                style={{ width: `${completionRate}%` }}
                            />
                        </div>
                        <div className="progress-text">
                            {completionRate.toFixed(1)}% å®Œæˆ ({stats.completed}/{stats.total})
                        </div>
                    </div>

                    {/* çŠ¶æ€ç­›é€‰å™¨ */}
                    <div className="filter-section">
                        <h3>ğŸ” çŠ¶æ€ç­›é€‰</h3>
                        <div className="filter-buttons">
                            {[
                                { key: 'all', label: 'å…¨éƒ¨ä»»åŠ¡', icon: 'ğŸ“‹' },
                                { key: 'pending', label: 'å¾…å®Œæˆ', icon: 'â³' },
                                { key: 'completed', label: 'å·²å®Œæˆ', icon: 'âœ…' },
                                { key: 'overdue', label: 'å·²é€¾æœŸ', icon: 'â°' }
                            ].map(({ key, label, icon }) => (
                                <button
                                    key={key}
                                    className={`filter-btn ${filter === key ? 'active' : ''}`}
                                    onClick={() => setFilter(key)}
                                >
                                    {icon} {label}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* ä¼˜å…ˆçº§ç­›é€‰å™¨ */}
                    <div className="filter-section">
                        <h3>ğŸ¯ ä¼˜å…ˆçº§ç­›é€‰</h3>
                        <div className="filter-buttons">
                            {[
                                { key: 'all', label: 'å…¨éƒ¨ä¼˜å…ˆçº§', icon: 'ğŸ¯' },
                                { key: 'high', label: 'é«˜ä¼˜å…ˆçº§', icon: 'ğŸ”´' },
                                { key: 'medium', label: 'ä¸­ä¼˜å…ˆçº§', icon: 'ğŸŸ¡' },
                                { key: 'low', label: 'ä½ä¼˜å…ˆçº§', icon: 'ğŸŸ¢' }
                            ].map(({ key, label, icon }) => (
                                <button
                                    key={key}
                                    className={`filter-btn ${priorityFilter === key ? 'active' : ''}`}
                                    onClick={() => setPriorityFilter(key)}
                                >
                                    {icon} {label}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* æ•°æ®å¯¼å‡º */}
                    <div className="export-section">
                        <h3>ğŸ’¾ æ•°æ®å¯¼å‡º</h3>
                        <div className="export-buttons">
                            <button 
                                className="export-btn"
                                onClick={() => onExport('json')}
                                title="å¯¼å‡ºä¸ºJSONæ ¼å¼"
                            >
                                ğŸ“„ JSON
                            </button>
                            <button 
                                className="export-btn"
                                onClick={() => onExport('csv')}
                                title="å¯¼å‡ºä¸ºCSVæ ¼å¼"
                            >
                                ğŸ“Š CSV
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // ===== Reactç»„ä»¶ï¼šæœç´¢æ  =====
        // æä¾›ä»»åŠ¡æœç´¢åŠŸèƒ½çš„ç»„ä»¶
        const SearchBar = ({ searchTerm, setSearchTerm }) => {
            return (
                <div className="search-container">
                    <div className="search-icon">ğŸ”</div>
                    <input
                        type="text"
                        className="search-input"
                        placeholder="æœç´¢ä»»åŠ¡æ ‡é¢˜æˆ–æè¿°..."
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                    />
                </div>
            );
        };

        // ===== Reactç»„ä»¶ï¼šç©ºçŠ¶æ€ =====
        // å½“æ²¡æœ‰ä»»åŠ¡æ—¶æ˜¾ç¤ºçš„ç©ºçŠ¶æ€ç»„ä»¶
        const EmptyState = ({ filter }) => {
            // æ ¹æ®å½“å‰ç­›é€‰æ¡ä»¶æ˜¾ç¤ºä¸åŒçš„ç©ºçŠ¶æ€æ¶ˆæ¯
            const getEmptyMessage = () => {
                switch (filter) {
                    case 'completed':
                        return {
                            icon: 'ğŸ‰',
                            title: 'è¿˜æ²¡æœ‰å®Œæˆçš„ä»»åŠ¡',
                            message: 'å®Œæˆä¸€äº›ä»»åŠ¡æ¥çœ‹åˆ°å®ƒä»¬å‡ºç°åœ¨è¿™é‡Œï¼'
                        };
                    case 'pending':
                        return {
                            icon: 'âœ¨',
                            title: 'æ²¡æœ‰å¾…å®Œæˆçš„ä»»åŠ¡',
                            message: 'å¤ªæ£’äº†ï¼ä½ å·²ç»å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡ã€‚'
                        };
                    case 'overdue':
                        return {
                            icon: 'â°',
                            title: 'æ²¡æœ‰é€¾æœŸä»»åŠ¡',
                            message: 'å¾ˆå¥½ï¼ä½ çš„æ—¶é—´ç®¡ç†å¾ˆæ£’ã€‚'
                        };
                    default:
                        return {
                            icon: 'ğŸ“',
                            title: 'è¿˜æ²¡æœ‰ä»»åŠ¡',
                            message: 'æ·»åŠ ä½ çš„ç¬¬ä¸€ä¸ªä»»åŠ¡å¼€å§‹ç®¡ç†ä½ çš„å¾…åŠäº‹é¡¹å§ï¼'
                        };
                }
            };

            const { icon, title, message } = getEmptyMessage();

            return (
                <div className="empty-state">
                    <div className="empty-state-icon">{icon}</div>
                    <h3>{title}</h3>
                    <p>{message}</p>
                </div>
            );
        };

        // ===== Reactç»„ä»¶ï¼šç¡®è®¤æ¨¡æ€æ¡† =====
        // ç”¨äºç¡®è®¤åˆ é™¤æ“ä½œçš„æ¨¡æ€æ¡†ç»„ä»¶
        const ConfirmModal = ({ isOpen, onClose, onConfirm, title, message }) => {
            // å¦‚æœæ¨¡æ€æ¡†æœªæ‰“å¼€ï¼Œä¸æ¸²æŸ“ä»»ä½•å†…å®¹
            if (!isOpen) return null;

            return (
                // æ¨¡æ€æ¡†é®ç½©å±‚ï¼Œç‚¹å‡»å¯å…³é—­
                <div className="modal-overlay" onClick={onClose}>
                    {/* æ¨¡æ€æ¡†ä¸»ä½“ï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡ */}
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        {/* æ¨¡æ€æ¡†å¤´éƒ¨ */}
                        <div className="modal-header">
                            <h3 className="modal-title">{title}</h3>
                            <button className="close-btn" onClick={onClose}>Ã—</button>
                        </div>
                        
                        {/* æ¨¡æ€æ¡†å†…å®¹ */}
                        <div style={{ marginBottom: '20px', padding: '0 25px' }}>
                            <p>{message}</p>
                        </div>
                        
                        {/* æ“ä½œæŒ‰é’® */}
                        <div style={{ display: 'flex', gap: '10px', justifyContent: 'flex-end', padding: '0 25px 25px' }}>
                            <button className="btn btn-secondary" onClick={onClose}>
                                å–æ¶ˆ
                            </button>
                            <button className="btn btn-danger" onClick={onConfirm}>
                                ç¡®è®¤åˆ é™¤
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // ===== ä¸»åº”ç”¨ç»„ä»¶ =====
        // è¿™æ˜¯æ•´ä¸ªTodoåº”ç”¨çš„æ ¹ç»„ä»¶ï¼Œç®¡ç†æ‰€æœ‰çŠ¶æ€å’Œä¸šåŠ¡é€»è¾‘
        const TodoApp = () => {
            // ===== çŠ¶æ€ç®¡ç† =====
            // ä½¿ç”¨è‡ªå®šä¹‰Hookç®¡ç†ä»»åŠ¡åˆ—è¡¨ï¼Œæ•°æ®ä¼šè‡ªåŠ¨ä¿å­˜åˆ°localStorage
            const [todos, setTodos] = useLocalStorage('todos', []);
            // å½“å‰ç­›é€‰æ¡ä»¶ï¼ˆall, pending, completed, overdueï¼‰
            const [filter, setFilter] = useState('all');
            // ä¼˜å…ˆçº§ç­›é€‰æ¡ä»¶ï¼ˆall, high, medium, lowï¼‰
            const [priorityFilter, setPriorityFilter] = useState('all');
            // æœç´¢å…³é”®è¯
            const [searchTerm, setSearchTerm] = useState('');
            // å½“å‰æ­£åœ¨ç¼–è¾‘çš„ä»»åŠ¡ï¼ˆnullè¡¨ç¤ºä¸åœ¨ç¼–è¾‘çŠ¶æ€ï¼‰
            const [editingTodo, setEditingTodo] = useState(null);
            // åˆ é™¤ç¡®è®¤æ¨¡æ€æ¡†çŠ¶æ€
            const [deleteModal, setDeleteModal] = useState({ isOpen: false, todoId: null });
            
            // ===== å­¦ä¹ è¿›åº¦è·Ÿè¸ª =====
            // å½“ç”¨æˆ·æ·»åŠ ä»»åŠ¡æ—¶ï¼Œæ ‡è®°é¡¹ç›®å®æˆ˜é˜¶æ®µä¸ºå·²å®Œæˆ
            useEffect(() => {
                if (todos.length > 0) {
                    const stageId = 'stage5';  // é¡¹ç›®å®æˆ˜é˜¶æ®µID
                    const savedProgress = localStorage.getItem('react19_learning_progress');
                    const progress = savedProgress ? JSON.parse(savedProgress) : {};
                    
                    // æ›´æ–°å­¦ä¹ è¿›åº¦
                    progress[stageId] = {
                        ...progress[stageId],
                        completed: 0,
                        total: 0,
                        accuracy: 0,
                        projectCompleted: true,  // æ ‡è®°é¡¹ç›®å·²å®Œæˆ
                        lastAccessed: new Date().toISOString()
                    };
                    
                    localStorage.setItem('react19_learning_progress', JSON.stringify(progress));
                }
            }, [todos.length]); // ä¾èµ–ä»»åŠ¡æ•°é‡

            // ===== é˜²æŠ–æœç´¢ =====
            // ä½¿ç”¨é˜²æŠ–Hookï¼Œé¿å…ç”¨æˆ·æ¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦å°±è§¦å‘æœç´¢
            const debouncedSearchTerm = useDebounce(searchTerm, 300);

            // ===== ä¸šåŠ¡é€»è¾‘å‡½æ•° =====
            
            // æ·»åŠ æ–°ä»»åŠ¡
            const addTodo = useCallback((todoData) => {
                const newTodo = {
                    id: generateId(),           // ç”Ÿæˆå”¯ä¸€ID
                    ...todoData,               // å±•å¼€è¡¨å•æ•°æ®
                    completed: false,          // é»˜è®¤æœªå®Œæˆ
                    createdAt: new Date().toISOString()  // åˆ›å»ºæ—¶é—´
                };
                // æ–°ä»»åŠ¡æ·»åŠ åˆ°åˆ—è¡¨å¼€å¤´
                setTodos(prev => [newTodo, ...prev]);
            }, [setTodos]);

            // æ›´æ–°ä»»åŠ¡
            const updateTodo = useCallback((id, updates) => {
                setTodos(prev => prev.map(todo => 
                    todo.id === id ? { ...todo, ...updates } : todo
                ));
                setEditingTodo(null);  // é€€å‡ºç¼–è¾‘æ¨¡å¼
            }, [setTodos]);

            // åˆ‡æ¢ä»»åŠ¡å®ŒæˆçŠ¶æ€
            const toggleTodo = useCallback((id) => {
                setTodos(prev => prev.map(todo => 
                    todo.id === id ? { ...todo, completed: !todo.completed } : todo
                ));
            }, [setTodos]);

            // åˆ é™¤ä»»åŠ¡
            const deleteTodo = useCallback((id) => {
                setTodos(prev => prev.filter(todo => todo.id !== id));
                setDeleteModal({ isOpen: false, todoId: null });  // å…³é—­ç¡®è®¤æ¨¡æ€æ¡†
            }, [setTodos]);

            // å¤„ç†åˆ é™¤æŒ‰é’®ç‚¹å‡»ï¼ˆæ˜¾ç¤ºç¡®è®¤æ¨¡æ€æ¡†ï¼‰
            const handleDeleteClick = (id) => {
                setDeleteModal({ isOpen: true, todoId: id });
            };

            // å¤„ç†æ•°æ®å¯¼å‡º
            const handleExport = (format) => {
                if (format === 'json') {
                    exportToJSON(todos);
                } else if (format === 'csv') {
                    exportToCSV(todos);
                }
            };

            // ===== ä»»åŠ¡ç­›é€‰å’Œæ’åº =====
            // ä½¿ç”¨useMemoç¼“å­˜ç­›é€‰ç»“æœï¼Œåªæœ‰å½“ä¾èµ–é¡¹å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—
            const filteredTodos = useMemo(() => {
                let filtered = todos;

                // ç¬¬ä¸€æ­¥ï¼šæŒ‰çŠ¶æ€ç­›é€‰
                switch (filter) {
                    case 'completed':
                        filtered = filtered.filter(todo => todo.completed);
                        break;
                    case 'pending':
                        filtered = filtered.filter(todo => !todo.completed);
                        break;
                    case 'overdue':
                        filtered = filtered.filter(todo => 
                            !todo.completed && todo.dueDate && isOverdue(todo.dueDate)
                        );
                        break;
                    // 'all' æƒ…å†µä¸éœ€è¦ç­›é€‰
                }

                // ç¬¬äºŒæ­¥ï¼šæŒ‰ä¼˜å…ˆçº§ç­›é€‰
                if (priorityFilter !== 'all') {
                    filtered = filtered.filter(todo => todo.priority === priorityFilter);
                }

                // ç¬¬ä¸‰æ­¥ï¼šæŒ‰æœç´¢è¯ç­›é€‰ï¼ˆæ ‡é¢˜å’Œæè¿°ï¼‰
                if (debouncedSearchTerm) {
                    const searchLower = debouncedSearchTerm.toLowerCase();
                    filtered = filtered.filter(todo => 
                        todo.title.toLowerCase().includes(searchLower) ||
                        todo.description.toLowerCase().includes(searchLower)
                    );
                }

                // ç¬¬å››æ­¥ï¼šæ’åº
                return filtered.sort((a, b) => {
                    // é¦–å…ˆæŒ‰å®ŒæˆçŠ¶æ€æ’åºï¼šæœªå®Œæˆçš„åœ¨å‰
                    if (a.completed !== b.completed) {
                        return a.completed - b.completed;
                    }
                    
                    // ç„¶åæŒ‰ä¼˜å…ˆçº§æ’åºï¼šé«˜ä¼˜å…ˆçº§åœ¨å‰
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                        return priorityOrder[b.priority] - priorityOrder[a.priority];
                    }
                    
                    // æœ€åæŒ‰åˆ›å»ºæ—¶é—´æ’åºï¼šæ–°åˆ›å»ºçš„åœ¨å‰
                    return new Date(b.createdAt) - new Date(a.createdAt);
                });
            }, [todos, filter, priorityFilter, debouncedSearchTerm]);

            // ===== ç»„ä»¶æ¸²æŸ“ =====
            return (
                <div className="container">
                    {/* é¡µé¢å¤´éƒ¨ */}
                    <div className="header">
                        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '10px'}}>
                            <div>
                                <h1>React 19 æ¡†æ¶ä½“éªŒ - Todoåº”ç”¨</h1>

                                <p>é«˜çº§Todoåº”ç”¨ - å®Œæ•´çš„ä»»åŠ¡ç®¡ç†è§£å†³æ–¹æ¡ˆ</p>
                            </div>
                            {/* è¿”å›å­¦ä¹ è·¯çº¿æŒ‰é’® */}
                            <button 
                                onClick={() => window.location.href = '../index.html'}
                                style={{
                                    background: 'rgba(255,255,255,0.2)',
                                    color: 'white',
                                    border: '1px solid rgba(255,255,255,0.3)',
                                    borderRadius: '8px',
                                    padding: '8px 16px',
                                    cursor: 'pointer',
                                    fontSize: '14px',
                                    transition: 'all 0.3s ease'
                                }}
                                onMouseOver={(e) => {
                                    e.target.style.background = 'rgba(255,255,255,0.3)';
                                }}
                                onMouseOut={(e) => {
                                    e.target.style.background = 'rgba(255,255,255,0.2)';
                                }}
                            >
                                ğŸ“– è¿”å›å­¦ä¹ è·¯çº¿
                            </button>
                        </div>
                    </div>

                    {/* åº”ç”¨ä¸»ä½“ï¼šä¾§è¾¹æ  + ä¸»å†…å®¹ */}
                    <div className="app-container">
                        {/* ä¾§è¾¹æ ï¼šç»Ÿè®¡ä¿¡æ¯å’Œç­›é€‰å™¨ */}
                        <Sidebar 
                            todos={todos}
                            filter={filter}
                            setFilter={setFilter}
                            priorityFilter={priorityFilter}
                            setPriorityFilter={setPriorityFilter}
                            onExport={handleExport}
                        />

                        {/* ä¸»å†…å®¹åŒºåŸŸ */}
                        <div className="main-content">
                            {/* ä»»åŠ¡è¡¨å•ï¼šæ·»åŠ æˆ–ç¼–è¾‘ä»»åŠ¡ */}
                            <TodoForm 
                                onAddTodo={addTodo}
                                editingTodo={editingTodo}
                                onUpdateTodo={updateTodo}
                                onCancelEdit={() => setEditingTodo(null)}
                            />

                            {/* æœç´¢æ  */}
                             <SearchBar 
                                 searchTerm={searchTerm}
                                 setSearchTerm={setSearchTerm}
                             />

                             {/* ä»»åŠ¡åˆ—è¡¨ */}
                             <div className="todo-list">
                                 {filteredTodos.length === 0 ? (
                                     // ç©ºçŠ¶æ€ï¼šæ²¡æœ‰ä»»åŠ¡æ—¶æ˜¾ç¤º
                                     <EmptyState filter={filter} />
                                 ) : (
                                     // ä»»åŠ¡åˆ—è¡¨ï¼šæ¸²æŸ“æ‰€æœ‰ç­›é€‰åçš„ä»»åŠ¡
                                     filteredTodos.map(todo => (
                                         <TodoItem
                                             key={todo.id}  // Reactéœ€è¦çš„å”¯ä¸€key
                                             todo={todo}
                                             onToggle={toggleTodo}
                                             onDelete={handleDeleteClick}
                                             onEdit={setEditingTodo}
                                         />
                                     ))
                                 )}
                             </div>
                         </div>
                     </div>

                     {/* åˆ é™¤ç¡®è®¤æ¨¡æ€æ¡† */}
                     <ConfirmModal
                         isOpen={deleteModal.isOpen}
                         onClose={() => setDeleteModal({ isOpen: false, todoId: null })}
                         onConfirm={() => deleteTodo(deleteModal.todoId)}
                         title="ç¡®è®¤åˆ é™¤"
                         message="ä½ ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä»»åŠ¡å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚"
                     />
                 </div>
             );
         };

         // ===== åº”ç”¨å¯åŠ¨ =====
         // ä½¿ç”¨React 19çš„æ–°APIåˆ›å»ºæ ¹èŠ‚ç‚¹å¹¶æ¸²æŸ“åº”ç”¨
         const root = ReactDOM.createRoot(document.getElementById('root'));
         root.render(<TodoApp />);
     </script>
 </body>
 </html>